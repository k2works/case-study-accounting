
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="財務会計システムの設計・開発ドキュメント">
      
      
        <meta name="author" content="Project Team">
      
      
      
        <link rel="prev" href="../chapter19/">
      
      
        <link rel="next" href="../chapter21/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>第20章 - 財務会計システム ケーススタディ</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#20" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="財務会計システム ケーススタディ" class="md-header__button md-logo" aria-label="財務会計システム ケーススタディ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            財務会計システム ケーススタディ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第20章
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/case-study-accounting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    case-study-accounting
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../requirements/requirements_definition/" class="md-tabs__link">
          
  
  
  要件定義

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../design/architecture_backend/" class="md-tabs__link">
          
  
  
  設計

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../development/release_plan/" class="md-tabs__link">
          
  
  
  開発

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../operation/dev_env/" class="md-tabs__link">
          
  
  
  運用

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/%E9%96%8B%E7%99%BA%E3%82%AC%E3%82%A4%E3%83%89/" class="md-tabs__link">
          
  
  
  リファレンス

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../template/ADR/" class="md-tabs__link">
          
  
  
  テンプレート

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  実践ガイド

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../functional-java/" class="md-tabs__link">
          
  
  
  関数型プログラミング実践ガイド

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="財務会計システム ケーススタディ" class="md-nav__button md-logo" aria-label="財務会計システム ケーススタディ" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    財務会計システム ケーススタディ
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/case-study-accounting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    case-study-accounting
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    要件定義
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    要件定義
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../requirements/requirements_definition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    要件定義書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../requirements/business_usecase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ビジネスユースケース
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../requirements/system_usecase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    システムユースケース
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../requirements/user_story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ユーザーストーリー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    アーキテクチャ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    アーキテクチャ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/architecture_backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    バックエンド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/architecture_frontend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    フロントエンド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/architecture_infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    インフラストラクチャ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    モデル設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    モデル設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/data-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    データモデル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/domain-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ドメインモデル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/ui-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UI 設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/test_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    テスト戦略
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/non_functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    非機能要件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/operation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    運用要件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/tech_stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術スタック選定
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    開発
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    開発
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/release_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    リリース計画
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    イテレーション計画
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    イテレーション計画
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/iteration_plan-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    イテレーション1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/iteration_plan-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    イテレーション2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ふりかえり
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ふりかえり
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/retrospective-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    イテレーション1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    運用
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    運用
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/dev_env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    開発環境解説
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/dev_container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    開発コンテナ構築手順書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/backend_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    バックエンド構築手順書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/backend_demo_env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    バックエンドデモ環境
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/frontend_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    フロントエンド構築手順書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/frontend_dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    フロントエンド開発手順
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/frontend_common_ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    フロントエンド共通 UI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/frontend_demo_env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    フロントエンドデモ環境
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/deploy_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    デモ環境デプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/third_party_service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    外部サービス連携
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/sonarqube_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SonarQube セットアップガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/e2e_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E2E テスト実行手順書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operation/github_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Project 運用ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    リファレンス
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    リファレンス
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    開発ガイドライン
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    開発ガイドライン
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E9%96%8B%E7%99%BA%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    開発ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%82%88%E3%81%84%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E3%81%A8%E3%81%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    よいソフトウェアとは
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%A8%E3%83%86%E3%82%B9%E3%83%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    コーディングとテストガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    エクストリームプログラミング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    分析・設計ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    分析・設計ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E8%A6%81%E4%BB%B6%E5%AE%9A%E7%BE%A9%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    要件定義ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9%E4%BD%9C%E6%88%90%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ユースケース作成ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E8%A8%AD%E8%A8%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    アーキテクチャ設計ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB%E8%A8%AD%E8%A8%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    データモデル設計ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%83%A2%E3%83%87%E3%83%AB%E8%A8%AD%E8%A8%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ドメインモデル設計ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/UI%E8%A8%AD%E8%A8%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UI設計ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E8%A8%AD%E8%A8%88%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    インフラ設計ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    非機能・運用ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    非機能・運用ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%83%86%E3%82%B9%E3%83%88%E6%88%A6%E7%95%A5%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    テスト戦略ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E9%9D%9E%E6%A9%9F%E8%83%BD%E8%A6%81%E4%BB%B6%E5%AE%9A%E7%BE%A9%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    非機能要件定義ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E9%81%8B%E7%94%A8%E8%A6%81%E4%BB%B6%E5%AE%9A%E7%BE%A9%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    運用要件定義ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%BB%E3%82%A4%E3%83%86%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E8%A8%88%E7%94%BB%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    リリース・イテレーション計画ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    環境構築ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    環境構築ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/Java%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Javaアプリケーション環境構築ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/TypeScript%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89%E3%82%AC%E3%82%A4%E3%83%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScriptアプリケーション環境構築ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/CodexCLIMCP%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Codex CLI MCP サーバー設定手順
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    テンプレート
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    テンプレート
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/ADR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E3%82%A4%E3%83%86%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%AE%8C%E4%BA%86%E5%A0%B1%E5%91%8A%E6%9B%B8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    イテレーション完了報告書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E3%82%A4%E3%83%B3%E3%82%BB%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%87%E3%83%83%E3%82%AD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    インセプションデッキ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E3%81%BE%E3%81%9A%E3%81%93%E3%82%8C%E3%82%92%E8%AA%AD%E3%82%82%E3%81%86%E3%83%AA%E3%82%B9%E3%83%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    まずこれを読もうリスト
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E5%AE%8C%E5%85%A8%E5%BD%A2%E5%BC%8F%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    完全形式のユースケース
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E8%A6%81%E4%BB%B6%E5%AE%9A%E7%BE%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    要件定義
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../template/%E8%A8%AD%E8%A8%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    実践ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    実践ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    バックエンド編（Java版）
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    バックエンド編（Java版）
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter00/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    はじめに
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    第20章
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#201" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.1 本章の概要
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.1 本章の概要">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        損益計算書とは
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        損益計算書の構成要素
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        アーキテクチャの全体像
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        パッケージ構成
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD の流れ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#202-domain-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.2 Domain Model の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.2 Domain Model の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2021-incomestatementcategory" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.2.1 IncomeStatementCategory 列挙型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2022-incomestatementitem" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.2.2 IncomeStatementItem ドメインモデル
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2023-incomestatement" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.2.3 IncomeStatement ドメインモデル
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#203-domain-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.3 Domain Model のテスト
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.3 Domain Model のテスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2031-incomestatementcategory" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.3.1 IncomeStatementCategory のテスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2032-incomestatementitem" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.3.2 IncomeStatementItem のテスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2033-incomestatement" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.3.3 IncomeStatement のテスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#204-output-port" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.4 Output Port の定義
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.4 Output Port の定義">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2041-incomestatementrepository" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.4.1 IncomeStatementRepository インターフェース
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#205-output-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.5 Output Adapter の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.5 Output Adapter の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2051-incomestatementmapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.5.1 IncomeStatementMapper インターフェース
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2052-mybatis-mapper-xml" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.5.2 MyBatis Mapper XML
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2053-incomestatementrepositoryimpl" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.5.3 IncomeStatementRepositoryImpl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#206-output-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.6 Output Adapter のテスト
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.6 Output Adapter のテスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2061-testcontainers" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.6.1 Testcontainers を使った統合テスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#207-input-port" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.7 Input Port の定義
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.7 Input Port の定義">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2071-incomestatementusecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.7.1 IncomeStatementUseCase インターフェース
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#208-application-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.8 Application Service の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.8 Application Service の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2081-incomestatementservice" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.8.1 IncomeStatementService
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#209-application-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.9 Application Service のテスト
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.9 Application Service のテスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2091-mockito" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.9.1 Mockito を使った単体テスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2010-input-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.10 Input Adapter の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.10 Input Adapter の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#20101-incomestatementcontroller" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.10.1 IncomeStatementController
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20102-dto" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.10.2 DTO クラス
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2011-input-adapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.11 Input Adapter のテスト
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.11 Input Adapter のテスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#20111-rest-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.11.1 REST API 統合テスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2012" class="md-nav__link">
    <span class="md-ellipsis">
      
        20.12 本章のまとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20.12 本章のまとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        実装したコンポーネント
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        設計のポイント
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        テストケース一覧
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第25章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第26章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第27章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第28章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第29章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第30章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第31章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第32章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    フロントエンド編（React版）
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    フロントエンド編（React版）
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter00/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    はじめに
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    関数型プログラミング実践ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    関数型プログラミング実践ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    関数型プログラミング（Java版）
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    関数型プログラミング（Java版）
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    はじめに
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV IO と副作用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functional-java/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="20">第20章: 損益計算書<a class="headerlink" href="#20" title="Permanent link">&para;</a></h1>
<h2 id="201">20.1 本章の概要<a class="headerlink" href="#201" title="Permanent link">&para;</a></h2>
<p>第6章で設計した日次勘定科目残高テーブルと勘定科目マスタを基に、損益計算書（Income Statement / P/L）の生成機能をヘキサゴナルアーキテクチャに従い、TDD で実装します。</p>
<h3 id="_1">損益計算書とは<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>損益計算書は、一定期間の経営成績を示す財務諸表です。収益と費用を対比させ、企業の利益（または損失）を段階的に計算します。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9Ijk2MnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTM5MHB4O2hlaWdodDo5NjJweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMzkwIDk2MiIgd2lkdGg9IjEzOTBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjU2MTM7JiMzMDQxMDsmIzM1MzM2OyYjMzE2Mzk7JiMyNjM2MDsmIzEyMzk4OyYjMjcwODM7JiMzNjg5Njs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTEuOTk5NSIgeD0iNjMyLjIxOCIgeT0iMjIuOTk1MSI+JiMyNTYxMzsmIzMwNDEwOyYjMzUzMzY7JiMzMTYzOTsmIzI2MzYwOyYjMTIzOTg7JiMyNzA4MzsmIzM2ODk2OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgPz8/Pz8/SW5jb21lIFN0YXRlbWVudD8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGlkPSJlbnQwMDAyIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjkxMi4zOSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjEwMDQiIHg9IjciIHk9IjQ0LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQzLjIwMTciIHg9IjM4Ny4zOTkxIiB5PSI1OS4yOTIiPiYjMjU2MTM7JiMzMDQxMDsmIzM1MzM2OyYjMzE2Mzk7JiMyNjM2MDsmIzY1Mjg4O0luY29tZSBTdGF0ZW1lbnQmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgc2FsZXMtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4uc2FsZXMiIGRhdGEtc291cmNlLWxpbmU9IjQiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSIjOTBFRTkwIiBoZWlnaHQ9Ijg5LjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzMTAiIHg9IjM2OCIgeT0iOTUuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSI1MDIuMDAwMSIgeT0iMTEwLjI5MiI+JiMyMjc3MDsmIzE5OTc4OyYjMzk2NDA7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBjb2dzLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLmNvZ3MiIGRhdGEtc291cmNlLWxpbmU9IjkiIGlkPSJlbnQwMDA2Ij48cmVjdCBmaWxsPSIjRkZGRkUwIiBoZWlnaHQ9IjE4Mi45IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMzM4IiB4PSIzOSIgeT0iMjI0LjU5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMTgwLjAwMDEiIHk9IjIzOS41OTIiPiYjMjI3NzA7JiMxOTk3ODsmIzIxNDA3OyYjMjAzODU7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBzZ2EtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4uc2dhIiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgaWQ9ImVudDAwMTAiPjxyZWN0IGZpbGw9IiNGRkZGRTAiIGhlaWdodD0iMjE4LjU5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjU0IiB4PSI0MTciIHk9IjMxOC4yMDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzOS45OTk0IiB4PSI0NzQuMDAwMyIgeT0iMzMzLjIwMiI+JiMzNjAwOTsmIzIyNzcwOyYjMzYwMjc7JiMyMTQ1MDsmIzEyNDAzOyYjMTk5Njg7JiMzMzMyNDsmIzMxNjQ5OyYjMjk3MDI7JiMzNjAyNzs8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIG5vbk9wUmV2LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLm5vbk9wUmV2IiBkYXRhLXNvdXJjZS1saW5lPSIyMSIgaWQ9ImVudDAwMTQiPjxyZWN0IGZpbGw9IiM5MEVFOTAiIGhlaWdodD0iODkuMyIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI2OCIgeD0iNzExIiB5PSI0NDcuNDk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSI4MTAuMDAwMiIgeT0iNDYyLjQ5MiI+JiMyMTk0MjsmIzI2OTg5OyYjMjI4MDY7JiMyMTQ1NDsmIzMwNDEwOzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgbm9uT3BFeHAtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4ubm9uT3BFeHAiIGRhdGEtc291cmNlLWxpbmU9IjI2IiBpZD0iZW50MDAxNyI+PHJlY3QgZmlsbD0iI0ZGRkZFMCIgaGVpZ2h0PSI4OS4zIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjU0IiB4PSI3MjUiIHk9IjU3Ni43OTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjgxNy4wMDAyIiB5PSI1OTEuNzkyIj4mIzIxOTQyOyYjMjY5ODk7JiMyMjgwNjsmIzM2MDI3OyYjMjk5OTI7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBleHRyYVJldi0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi5JbmNvbWUgU3RhdGVtZW50Li5leHRyYVJldiIgZGF0YS1zb3VyY2UtbGluZT0iMzEiIGlkPSJlbnQwMDIwIj48cmVjdCBmaWxsPSIjOTBFRTkwIiBoZWlnaHQ9Ijg5LjI5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTg1IiB4PSI3OTQiIHk9IjcwNi4wOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9Ijg1OC41MDAxIiB5PSI3MjEuMDkyIj4mIzI5MzA1OyYjMjEwMjk7JiMyMTAzMzsmIzMwNDEwOzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgZXh0cmFFeHAtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4uZXh0cmFFeHAiIGRhdGEtc291cmNlLWxpbmU9IjM1IiBpZD0iZW50MDAyMiI+PHJlY3QgZmlsbD0iI0ZGRkZFMCIgaGVpZ2h0PSI4OS4zIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTg1IiB4PSI3OTQiIHk9IjgzNS4zODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9Ijg1OC41MDAxIiB5PSI4NTAuMzgyIj4mIzI5MzA1OyYjMjEwMjk7JiMyNTYxMzsmIzIyODMzOzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLnNhbGVzLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBpZD0iZW50MDAwNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI4OS45OTk3IiB4PSIzOTIiIHk9IjEzOC4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDAyIiB5PSIxNTQuMjkyIj4mIzIxODMwOyYjMjE2OTc7JiMyMjc3MDsmIzE5OTc4OyYjMzk2NDA7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi5JbmNvbWUgU3RhdGVtZW50Li5zYWxlcy4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBpZD0iZW50MDAwNSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTcuOTk5NiIgeD0iNTE3IiB5PSIxMzguMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjUyNyIgeT0iMTU0LjI5MiI+JiMxMjQ2OTsmIzEyNTQwOyYjMTI0OTk7JiMxMjQ3MzsmIzIyNzcwOyYjMTk5Nzg7JiMzOTY0MDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLmNvZ3MuLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGlkPSJlbnQwMDA3Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNy45OTk2IiB4PSI2MyIgeT0iMjY3LjU5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSI3MyIgeT0iMjgzLjU5MiI+JiMyNjM5OTsmIzM5MzE4OyYjMjE4MzA7JiMyMTY5NzsmIzI2ODQyOyYjMjEzNjg7JiMzOTY0MDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLmNvZ3MuLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGlkPSJlbnQwMDA4Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNy45OTk2IiB4PSIyMTYiIHk9IjI2Ny41OTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iMjI2IiB5PSIyODMuNTkyIj4mIzI0NDAzOyYjMjYzOTk7JiMyMTgzMDsmIzIxNjk3OyYjMjAxODE7JiMyMDgzNzsmIzM5NjQwOzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4uY29ncy4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgaWQ9ImVudDAwMDkiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTE3Ljk5OTYiIHg9IjYzIiB5PSIzNjEuMjA2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjczIiB5PSIzNzcuMjAyIj4mIzI2Mzk5OyYjMjY0MTE7JiMyMTgzMDsmIzIxNjk3OyYjMjY4NDI7JiMyMTM2ODsmIzM5NjQwOzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi5JbmNvbWUgU3RhdGVtZW50Li5zZ2EuLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgaWQ9ImVudDAwMTEiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjEuOTk5OCIgeD0iNDQxIiB5PSIzNjEuMjA2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjk5OTgiIHg9IjQ1MSIgeT0iMzc3LjIwMiI+JiMyMDE1NDsmIzIwMjE0OyYjMzYwMjc7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4uc2dhLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxNyIgaWQ9ImVudDAwMTIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODkuOTk5NyIgeD0iNTM4IiB5PSIzNjEuMjA2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjU0OCIgeT0iMzc3LjIwMiI+JiMyNDE5NTsmIzIxNTc4OyYjMjM0NTk7JiMyMDI1MzsmIzM2MDI3OzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLnNnYS4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGlkPSJlbnQwMDEzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijg5Ljk5OTciIHg9IjQ0MSIgeT0iNDkwLjQ5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSI0NTEiIHk9IjUwNi40OTIiPiYjMjgxODc7JiMyMDM4NTsmIzIwNzY3OyYjMjEzNjQ7JiMzNjAyNzs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLm5vbk9wUmV2Li4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjIyIiBpZD0iZW50MDAxNSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3NS45OTk4IiB4PSI3MzUiIHk9IjQ5MC40OTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNzQ1IiB5PSI1MDYuNDkyIj4mIzIxNDYzOyYjMjE0NjI7JiMyMTAzMzsmIzI0Njg3OzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLm5vbk9wUmV2Li4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgaWQ9ImVudDAwMTYiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODkuOTk5NyIgeD0iODQ2IiB5PSI0OTAuNDk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9Ijg1NiIgeT0iNTA2LjQ5MiI+JiMyMTQ2MzsmIzIxNDYyOyYjMzcxOTc7JiMyNDQwMzsmIzM3MzI5OzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uSW5jb21lIFN0YXRlbWVudC4ubm9uT3BFeHAuLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMjciIGlkPSJlbnQwMDE4Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijc1Ljk5OTgiIHg9Ijc0OSIgeT0iNjE5Ljc5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSI3NTkiIHk9IjYzNS43OTIiPiYjMjU5MDM7JiMyNTE3MzsmIzIxMDMzOyYjMjQ2ODc7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi5JbmNvbWUgU3RhdGVtZW50Li5ub25PcEV4cC4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIyOCIgaWQ9ImVudDAwMTkiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNzUuOTk5OCIgeD0iODYwIiB5PSI2MTkuNzk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9Ijg3MCIgeT0iNjM1Ljc5MiI+JiMyODg1ODsmIzI2MzY3OyYjMjQwNDY7JiMyNTYxMzs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLmV4dHJhUmV2Li4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjMyIiBpZD0iZW50MDAyMSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTcuOTk5NiIgeD0iODE4IiB5PSI3NDkuMDk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjgyOCIgeT0iNzY1LjA5MiI+JiMyMjI2NjsmIzIzNDUwOyYjMzYwMzk7JiMyOTk4NzsmIzIyNzcwOyYjMjEzNjQ7JiMzMDQxMDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLkluY29tZSBTdGF0ZW1lbnQuLmV4dHJhRXhwLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjM2IiBpZD0iZW50MDAyMyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTcuOTk5NiIgeD0iODE4IiB5PSI4NzguMzg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjgyOCIgeT0iODk0LjM4MiI+JiMyMjI2NjsmIzIzNDUwOyYjMzYwMzk7JiMyOTk4NzsmIzIyNzcwOyYjMjEzNjQ7JiMyNTYxMzs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IkdNTjMwIiBkYXRhLXNvdXJjZS1saW5lPSI0OCIgaWQ9ImVudDAwMzEiPjxwYXRoIGQ9Ik0xMDI2LjU1LDEyNi45ODY5IEwxMDI2LjU1LDE3MS45MDg3IEwxMTg1LjQ0MjMsMTcxLjkwODcgTDExODUuNDQyMywxMzYuOTg2OSBMMTE3NS40NDIzLDEyNi45ODY5IEwxMDI2LjU1LDEyNi45ODY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTE3NS40NDIzLDEyNi45ODY5IEwxMTc1LjQ0MjMsMTM2Ljk4NjkgTDExODUuNDQyMywxMzYuOTg2OSBMMTE3NS40NDIzLDEyNi45ODY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1LjAwMDEiIHg9IjEwMzIuNTUiIHk9IjE0NC4wNTM4Ij4mIzIyNzcwOyYjMTk5Nzg7JiMzMjIwNzsmIzIxMDMzOyYjMzA0MTA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE3IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzcuODkyMyIgeD0iMTAzMi41NSIgeT0iMTYyLjg5OTUiPiYjMjI3NzA7JiMxOTk3ODsmIzM5NjQwOyAtICYjMjI3NzA7JiMxOTk3ODsmIzIxNDA3OyYjMjAzODU7PC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJHTU4zMyIgZGF0YS1zb3VyY2UtbGluZT0iNTMiIGlkPSJlbnQwMDM0Ij48cGF0aCBkPSJNMTAyNy4wNSwzNDkuODg2OSBMMTAyNy4wNSwzOTQuODA4OCBMMTIwMi45NDIyLDM5NC44MDg4IEwxMjAyLjk0MjIsMzU5Ljg4NjkgTDExOTIuOTQyMiwzNDkuODg2OSBMMTAyNy4wNSwzNDkuODg2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTExOTIuOTQyMiwzNDkuODg2OSBMMTE5Mi45NDIyLDM1OS44ODY5IEwxMjAyLjk0MjIsMzU5Ljg4NjkgTDExOTIuOTQyMiwzNDkuODg2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSIxMDMzLjA1IiB5PSIzNjYuOTUzOCI+JiMyMTk0MjsmIzI2OTg5OyYjMjEwMzM7JiMzMDQxMDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTciIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1NC44OTIyIiB4PSIxMDMzLjA1IiB5PSIzODUuNzk5NSI+JiMyMjc3MDsmIzE5OTc4OyYjMzIyMDc7JiMyMTAzMzsmIzMwNDEwOyAtICYjMzYwMDk7JiMzMTY0OTsmIzM2MDI3OzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iR01OMzYiIGRhdGEtc291cmNlLWxpbmU9IjU4IiBpZD0iZW50MDAzNyI+PHBhdGggZD0iTTEwMjcuMDEsNjA4LjQ4NjkgTDEwMjcuMDEsNjUzLjQwODcgTDEzMzAuOTgzLDY1My40MDg3IEwxMzMwLjk4Myw2MTguNDg2OSBMMTMyMC45ODMsNjA4LjQ4NjkgTDEwMjcuMDEsNjA4LjQ4NjkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xMzIwLjk4Myw2MDguNDg2OSBMMTMyMC45ODMsNjE4LjQ4NjkgTDEzMzAuOTgzLDYxOC40ODY5IEwxMzIwLjk4Myw2MDguNDg2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSIxMDMzLjAxIiB5PSI2MjUuNTUzOCI+JiMzMjA3NjsmIzI0MTIwOyYjMjEwMzM7JiMzMDQxMDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTciIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4Mi45NzMiIHg9IjEwMzMuMDEiIHk9IjY0NC4zOTk1Ij4mIzIxOTQyOyYjMjY5ODk7JiMyMTAzMzsmIzMwNDEwOyArICYjMjE5NDI7JiMyNjk4OTsmIzIyODA2OyYjMjE0NTQ7JiMzMDQxMDsgLSAmIzIxOTQyOyYjMjY5ODk7JiMyMjgwNjsmIzM2MDI3OyYjMjk5OTI7PC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJHTU4zOSIgZGF0YS1zb3VyY2UtbGluZT0iNjMiIGlkPSJlbnQwMDQwIj48cGF0aCBkPSJNMTAyNi41Nyw4NjcuMDc2OSBMMTAyNi41Nyw5MTEuOTk4OCBMMTM4My40MzU0LDkxMS45OTg4IEwxMzgzLjQzNTQsODc3LjA3NjkgTDEzNzMuNDM1NCw4NjcuMDc2OSBMMTAyNi41Nyw4NjcuMDc2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEzNzMuNDM1NCw4NjcuMDc2OSBMMTM3My40MzU0LDg3Ny4wNzY5IEwxMzgzLjQzNTQsODc3LjA3NjkgTDEzNzMuNDM1NCw4NjcuMDc2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS4wMDAxIiB4PSIxMDMyLjU3IiB5PSI4ODQuMTQzOCI+JiMyNDQwMzsmIzI2Mzk5OyYjMzIwMjA7JiMyMTAzMzsmIzMwNDEwOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNyIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzM1Ljg2NTQiIHg9IjEwMzIuNTciIHk9IjkwMi45ODk1Ij4mIzMyMDc2OyYjMjQxMjA7JiMyMTAzMzsmIzMwNDEwOyArICYjMjkzMDU7JiMyMTAyOTsmIzIxMDMzOyYjMzA0MTA7IC0gJiMyOTMwNTsmIzIxMDI5OyYjMjU2MTM7JiMyMjgzMzsgLSAmIzI3ODYxOyYjMjAxNTQ7JiMzMTI0NjsmIzMxNTYxOzwvdGV4dD48L2c+PCEtLWxpbmsgc2FsZXMgdG8gY29ncy0tPjwhLS1saW5rIGNvZ3MgdG8gc2dhLS0+PCEtLWxpbmsgc2dhIHRvIG5vbk9wUmV2LS0+PCEtLWxpbmsgbm9uT3BSZXYgdG8gbm9uT3BFeHAtLT48IS0tbGluayBub25PcEV4cCB0byBleHRyYVJldi0tPjwhLS1saW5rIGV4dHJhUmV2IHRvIGV4dHJhRXhwLS0+PCEtLWxpbmsgc2FsZXMgdG8gR01OMzAtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMyIgZGF0YS1lbnRpdHktMj0iZW50MDAzMSIgZGF0YS1saW5rLXR5cGU9ImFzc29jaWF0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI0OCIgaWQ9ImxuazMyIj48cGF0aCBkPSJNNjc5LjE3NjQsMTQ5LjQ0NjkgQzY4MC4xMDE2LDE0OS40NDY5IDY4MS4wMjY3LDE0OS40NDY5IDY4MS45NTE5LDE0OS40NDY5IEM2ODUuNjUyNSwxNDkuNDQ2OSA2ODkuMzUzMSwxNDkuNDQ2OSA2OTMuMDUzNywxNDkuNDQ2OSBDNzAwLjQ1NSwxNDkuNDQ2OSA3MDcuODU2MiwxNDkuNDQ2OSA3MTUuMjU3NSwxNDkuNDQ2OSBDNzMwLjA2LDE0OS40NDY5IDc0NC44NjI1LDE0OS40NDY5IDc1OS42NjUsMTQ5LjQ0NjkgQzc4OS4yNywxNDkuNDQ2OSA4MTguODc1LDE0OS40NDY5IDg0OC40OCwxNDkuNDQ2OSBDOTA3LjY5LDE0OS40NDY5IDk2Ni45LDE0OS40NDY5IDEwMjYuMTEsMTQ5LjQ0NjkiIGZpbGw9Im5vbmUiIGlkPSJzYWxlcy1HTU4zMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tbGluayBzZ2EgdG8gR01OMzMtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAxMCIgZGF0YS1lbnRpdHktMj0iZW50MDAzNCIgZGF0YS1saW5rLXR5cGU9ImFzc29jaWF0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI1MyIgaWQ9ImxuazM1Ij48cGF0aCBkPSJNNjcxLjk1NjMsMzcyLjM0NjkgQzY3Mi45MDI1LDM3Mi4zNDY5IDY3My44NDg4LDM3Mi4zNDY5IDY3NC43OTUsMzcyLjM0NjkgQzY3OC41OCwzNzIuMzQ2OSA2ODIuMzY1LDM3Mi4zNDY5IDY4Ni4xNSwzNzIuMzQ2OSBDNjkzLjcyLDM3Mi4zNDY5IDcwMS4yOSwzNzIuMzQ2OSA3MDguODYsMzcyLjM0NjkgQzcyNCwzNzIuMzQ2OSA3MzkuMTQsMzcyLjM0NjkgNzU0LjI4LDM3Mi4zNDY5IEM3ODQuNTYsMzcyLjM0NjkgODE0Ljg0LDM3Mi4zNDY5IDg0NS4xMiwzNzIuMzQ2OSBDOTA1LjY4LDM3Mi4zNDY5IDk2Ni4yNCwzNzIuMzQ2OSAxMDI2LjgsMzcyLjM0NjkiIGZpbGw9Im5vbmUiIGlkPSJzZ2EtR01OMzMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48L2c+PCEtLWxpbmsgbm9uT3BFeHAgdG8gR01OMzYtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAxNyIgZGF0YS1lbnRpdHktMj0iZW50MDAzNyIgZGF0YS1saW5rLXR5cGU9ImFzc29jaWF0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI1OCIgaWQ9ImxuazM4Ij48cGF0aCBkPSJNOTc5LjEyMDgsNjMwLjk0NjkgQzk3OS4yNjQyLDYzMC45NDY5IDk3OS40MDc1LDYzMC45NDY5IDk3OS41NTA5LDYzMC45NDY5IEM5NzkuODM3NSw2MzAuOTQ2OSA5ODAuMTI0Miw2MzAuOTQ2OSA5ODAuNDEwOSw2MzAuOTQ2OSBDOTgwLjk4NDMsNjMwLjk0NjkgOTgxLjU1NzYsNjMwLjk0NjkgOTgyLjEzMSw2MzAuOTQ2OSBDOTgzLjI3NzYsNjMwLjk0NjkgOTg0LjQyNDMsNjMwLjk0NjkgOTg1LjU3MDksNjMwLjk0NjkgQzk5MC4xNTc1LDYzMC45NDY5IDk5NC43NDM3LDYzMC45NDY5IDk5OS4zMyw2MzAuOTQ2OSBDMTAwOC41MDI1LDYzMC45NDY5IDEwMTcuNjc1LDYzMC45NDY5IDEwMjYuODUsNjMwLjk0NjkiIGZpbGw9Im5vbmUiIGlkPSJub25PcEV4cC1HTU4zNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tbGluayBleHRyYUV4cCB0byBHTU4zOS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDIyIiBkYXRhLWVudGl0eS0yPSJlbnQwMDQwIiBkYXRhLWxpbmstdHlwZT0iYXNzb2NpYXRpb24iIGRhdGEtc291cmNlLWxpbmU9IjYzIiBpZD0ibG5rNDEiPjxwYXRoIGQ9Ik05NzkuMTU1NSw4ODkuNTM2OSBDOTc5LjQ0MDYsODg5LjUzNjkgOTc5LjcyNTYsODg5LjUzNjkgOTgwLjAxMDcsODg5LjUzNjkgQzk4MC41ODA3LDg4OS41MzY5IDk4MS4xNTA4LDg4OS41MzY5IDk4MS43MjA5LDg4OS41MzY5IEM5ODIuODYxMSw4ODkuNTM2OSA5ODQuMDAxMyw4ODkuNTM2OSA5ODUuMTQxNiw4ODkuNTM2OSBDOTg5LjcwMjUsODg5LjUzNjkgOTk0LjI2MzgsODg5LjUzNjkgOTk4LjgyNSw4ODkuNTM2OSBDMTAwNy45NDc1LDg4OS41MzY5IDEwMTcuMDcsODg5LjUzNjkgMTAyNi4xOSw4ODkuNTM2OSIgZmlsbD0ibm9uZSIgaWQ9ImV4dHJhRXhwLUdNTjM5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheTo3LDc7Ii8+PC9nPjw/cGxhbnR1bWwtc3JjIFRMRkJSamYwNUR0Rkx1cGVwWE1WcUV3d3dBZklrd293aTYzZzgxNHgwZ2o5TExLQXEySTY1YVo0OHJMOEhJRDJJdko2S0k0RjFzWnhDVlJDbTJnX3E2aXhjQzdXZlV5ekZrVlVDLVZnQUpyRENEaWx5clBmcVpFdVVTWFFiZnFwc1NfRnEtdGwyNkw4R2ZUTDFKMm40RVgtUjNuTjR6ZXdtUXpxTUlWaEhETmxueUtPX1kzLUdwanpub2ZEcHhfNmk5cDVNSmJEaWxYSEVnTWl3S2c2NDFOMDJKY0oxNW5aYnpQb1NfSDNzU3ZWc3VNbk5RWlAtSmtYLUg0alF6MUFzX2J4dWlhYUQ2TWN5ZndhcXpmYzhDRUVzekNWSkwtQ1RPdmVzSEI0dzl5UXpGc2NDc2hHZFF4R1gwdXhGYl93U3Q2SUlWeUNYZmRxSHhIUWlkQzNuemdVNkItdVVTQnRUdzdlTXczOGdxVHBYYURkVEVGMlBrQ0MyX0lXSENzRUNfdWNiOWRMV1p0ZmZwT2pOdGRiYTFkRDZ6UXplQVRETWd0MFF0Y1FnZ1EtczdYOXRncnNsZGY4Z3FyZ2RCN1NQTW9YRGpxZldvTkpsT0Q4M1QzZHpUdlN1emRNSGVKbHpLak1SMm9BeUZvR2pWeEhNbkRvNUxSV25KamdUMDRfTXU1aXdIYXZTZU5NYTlmN2F5NFVodFYwVnAzNl9NcWI5TVpIcXp6cG9pWTlicGFWbldITUZ5Um5yc2tmUDlBZVJ2QlFmWGZfd2dLRVVUNEJULTNEYVZsa3VWaGlOTDNtRzJpSEMyQ0F4MHFaUGlRV21BNkwyOVMzSTdJMkMtd29NN2xoN29FSTlGenktNnRManJrSXExQ1N0MWdFT182eTQ1NkpzQUxQOGVDTFdTZUZIZldkdTBPc0UxNHUyMFhFOTVNbWlvSm53b19LaWFHLUdHMF9uZzZta3lDa0haREk5MzA1WGxSRWRiX0wxSHJINjdKNEU4QTg2Mk51UDhDNjcyX2xMVlg1Q0gzeTNtMDA/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_2">損益計算書の構成要素<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>区分</th>
<th>科目区分</th>
<th>勘定科目コード範囲</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>収益</td>
<td>売上高</td>
<td>41xx</td>
<td>本業からの収益</td>
</tr>
<tr>
<td>収益</td>
<td>営業外収益</td>
<td>42xx</td>
<td>本業以外の収益</td>
</tr>
<tr>
<td>収益</td>
<td>特別利益</td>
<td>43xx</td>
<td>臨時的な利益</td>
</tr>
<tr>
<td>費用</td>
<td>売上原価</td>
<td>51xx</td>
<td>商品・製品の原価</td>
</tr>
<tr>
<td>費用</td>
<td>販売費及び一般管理費</td>
<td>52xx〜59xx</td>
<td>営業活動の費用</td>
</tr>
<tr>
<td>費用</td>
<td>営業外費用</td>
<td>61xx</td>
<td>本業以外の費用</td>
</tr>
<tr>
<td>費用</td>
<td>特別損失</td>
<td>62xx</td>
<td>臨時的な損失</td>
</tr>
<tr>
<td>費用</td>
<td>法人税等</td>
<td>71xx</td>
<td>法人税、住民税、事業税</td>
</tr>
</tbody>
</table>
<h3 id="_3">アーキテクチャの全体像<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjM2M3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjEyMnB4O2hlaWdodDozNjNweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyMTIyIDM2MyIgd2lkdGg9IjIxMjJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIGluZnJhc3RydWN0dXJlP0lucHV0IEFkYXB0ZXI/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImluZnJhc3RydWN0dXJlLklucHV0IEFkYXB0ZXIuIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBpZD0iZW50MDAwMiI+PHBhdGggZD0iTTEyNDIuNSwxMTEuNzkgTDE0OTIuMTA5MywxMTEuNzkgQTMuNzUsMy43NSAwIDAgMSAxNDk0LjYwOTMsMTE0LjI5IEwxNTAxLjYwOTMsMTM0LjA4NjkgTDE1MDEuNSwxMzQuMDg2OSBBMi41LDIuNSAwIDAgMSAxNTA0LDEzNi41ODY5IEwxNTA0LDE5Ni41OSBBMi41LDIuNSAwIDAgMSAxNTAxLjUsMTk5LjA5IEwxMjQyLjUsMTk5LjA5IEEyLjUsMi41IDAgMCAxIDEyNDAsMTk2LjU5IEwxMjQwLDExNC4yOSBBMi41LDIuNSAwIDAgMSAxMjQyLjUsMTExLjc5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxMjQwIiB4Mj0iMTUwMS42MDkzIiB5MT0iMTM0LjA4NjkiIHkyPSIxMzQuMDg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNDguNjA5MyIgeD0iMTI0NCIgeT0iMTI2Ljc4NTEiPmluZnJhc3RydWN0dXJlJiM2NTI4ODtJbnB1dCBBZGFwdGVyJiM2NTI4OTs8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGFwcGxpY2F0aW9uLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImFwcGxpY2F0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI3IiBpZD0iZW50MDAwNCI+PHBhdGggZD0iTTY2Ni41LDY4Ljc5IEw3NTUuNDEwMiw2OC43OSBBMy43NSwzLjc1IDAgMCAxIDc1Ny45MTAyLDcxLjI5IEw3NjQuOTEwMiw5MS4wODY5IEwxMjEzLjUsOTEuMDg2OSBBMi41LDIuNSAwIDAgMSAxMjE2LDkzLjU4NjkgTDEyMTYsMzUzLjU5IEEyLjUsMi41IDAgMCAxIDEyMTMuNSwzNTYuMDkgTDY2Ni41LDM1Ni4wOSBBMi41LDIuNSAwIDAgMSA2NjQsMzUzLjU5IEw2NjQsNzEuMjkgQTIuNSwyLjUgMCAwIDEgNjY2LjUsNjguNzkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjY2NCIgeDI9Ijc2NC45MTAyIiB5MT0iOTEuMDg2OSIgeTI9IjkxLjA4NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODcuOTEwMiIgeD0iNjY4IiB5PSI4My43ODUxIj5hcHBsaWNhdGlvbjwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgcG9ydC5pbj9JbnB1dCBQb3J0Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJhcHBsaWNhdGlvbi5wb3J0LmluLklucHV0IFBvcnQuIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBpZD0iZW50MDAwNSI+PHBhdGggZD0iTTY5MC41LDIyMy4wOSBMODUzLjAyNjIsMjIzLjA5IEEzLjc1LDMuNzUgMCAwIDEgODU1LjUyNjIsMjI1LjU5IEw4NjIuNTI2MiwyNDUuMzg2OSBMOTE3LjUsMjQ1LjM4NjkgQTIuNSwyLjUgMCAwIDEgOTIwLDI0Ny44ODY5IEw5MjAsMzI5LjU5IEEyLjUsMi41IDAgMCAxIDkxNy41LDMzMi4wOSBMNjkwLjUsMzMyLjA5IEEyLjUsMi41IDAgMCAxIDY4OCwzMjkuNTkgTDY4OCwyMjUuNTkgQTIuNSwyLjUgMCAwIDEgNjkwLjUsMjIzLjA5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI2ODgiIHgyPSI4NjIuNTI2MiIgeTE9IjI0NS4zODY5IiB5Mj0iMjQ1LjM4NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYxLjUyNjIiIHg9IjY5MiIgeT0iMjM4LjA4NTEiPnBvcnQuaW4mIzY1Mjg4O0lucHV0IFBvcnQmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgc2VydmljZS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJhcHBsaWNhdGlvbi5zZXJ2aWNlIiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgaWQ9ImVudDAwMDciPjxwYXRoIGQ9Ik02OTIuNSwxMTEuNzkgTDc0OS45NTEyLDExMS43OSBBMy43NSwzLjc1IDAgMCAxIDc1Mi40NTEyLDExNC4yOSBMNzU5LjQ1MTIsMTM0LjA4NjkgTDkxNS41LDEzNC4wODY5IEEyLjUsMi41IDAgMCAxIDkxOCwxMzYuNTg2OSBMOTE4LDE5Ni41OSBBMi41LDIuNSAwIDAgMSA5MTUuNSwxOTkuMDkgTDY5Mi41LDE5OS4wOSBBMi41LDIuNSAwIDAgMSA2OTAsMTk2LjU5IEw2OTAsMTE0LjI5IEEyLjUsMi41IDAgMCAxIDY5Mi41LDExMS43OSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNjkwIiB4Mj0iNzU5LjQ1MTIiIHkxPSIxMzQuMDg2OSIgeTI9IjEzNC4wODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU2LjQ1MTIiIHg9IjY5NCIgeT0iMTI2Ljc4NTEiPnNlcnZpY2U8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIHBvcnQub3V0P091dHB1dCBQb3J0Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJhcHBsaWNhdGlvbi5wb3J0Lm91dC5PdXRwdXQgUG9ydC4iIGRhdGEtc291cmNlLWxpbmU9IjE0IiBpZD0iZW50MDAwOSI+PHBhdGggZD0iTTk0Ni41LDIyMy4wOSBMMTEzMy45MjI3LDIyMy4wOSBBMy43NSwzLjc1IDAgMCAxIDExMzYuNDIyNywyMjUuNTkgTDExNDMuNDIyNywyNDUuMzg2OSBMMTE4OS41LDI0NS4zODY5IEEyLjUsMi41IDAgMCAxIDExOTIsMjQ3Ljg4NjkgTDExOTIsMzI5LjU5IEEyLjUsMi41IDAgMCAxIDExODkuNSwzMzIuMDkgTDk0Ni41LDMzMi4wOSBBMi41LDIuNSAwIDAgMSA5NDQsMzI5LjU5IEw5NDQsMjI1LjU5IEEyLjUsMi41IDAgMCAxIDk0Ni41LDIyMy4wOSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iOTQ0IiB4Mj0iMTE0My40MjI3IiB5MT0iMjQ1LjM4NjkiIHkyPSIyNDUuMzg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODYuNDIyNyIgeD0iOTQ4IiB5PSIyMzguMDg1MSI+cG9ydC5vdXQmIzY1Mjg4O091dHB1dCBQb3J0JiM2NTI4OTs8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGRvbWFpbi5tb2RlbC0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJkb21haW4ubW9kZWwiIGRhdGEtc291cmNlLWxpbmU9IjE5IiBpZD0iZW50MDAxMSI+PHBhdGggZD0iTTguNSwyMzMuOTQgTDEyMS43ODAzLDIzMy45NCBBMy43NSwzLjc1IDAgMCAxIDEyNC4yODAzLDIzNi40NCBMMTMxLjI4MDMsMjU2LjIzNjkgTDYzNy41LDI1Ni4yMzY5IEEyLjUsMi41IDAgMCAxIDY0MCwyNTguNzM2OSBMNjQwLDMxOC43NCBBMi41LDIuNSAwIDAgMSA2MzcuNSwzMjEuMjQgTDguNSwzMjEuMjQgQTIuNSwyLjUgMCAwIDEgNiwzMTguNzQgTDYsMjM2LjQ0IEEyLjUsMi41IDAgMCAxIDguNSwyMzMuOTQiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjYiIHgyPSIxMzEuMjgwMyIgeTE9IjI1Ni4yMzY5IiB5Mj0iMjU2LjIzNjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEyLjI4MDMiIHg9IjEwIiB5PSIyNDguOTM1MSI+ZG9tYWluLm1vZGVsPC90ZXh0PjwvZz48IS0tY2x1c3RlciBpbmZyYXN0cnVjdHVyZT9PdXRwdXQgQWRhcHRlcj8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iaW5mcmFzdHJ1Y3R1cmUuT3V0cHV0IEFkYXB0ZXIuIiBkYXRhLXNvdXJjZS1saW5lPSIyNSIgaWQ9ImVudDAwMTUiPjxwYXRoIGQ9Ik0xNTMwLjUsMTExLjc5IEwxNzkzLjQ5NCwxMTEuNzkgQTMuNzUsMy43NSAwIDAgMSAxNzk1Ljk5NCwxMTQuMjkgTDE4MDIuOTk0LDEzNC4wODY5IEwxODA3LjUsMTM0LjA4NjkgQTIuNSwyLjUgMCAwIDEgMTgxMCwxMzYuNTg2OSBMMTgxMCwzMTguNzQgQTIuNSwyLjUgMCAwIDEgMTgwNy41LDMyMS4yNCBMMTUzMC41LDMyMS4yNCBBMi41LDIuNSAwIDAgMSAxNTI4LDMxOC43NCBMMTUyOCwxMTQuMjkgQTIuNSwyLjUgMCAwIDEgMTUzMC41LDExMS43OSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTUyOCIgeDI9IjE4MDIuOTk0IiB5MT0iMTM0LjA4NjkiIHkyPSIxMzQuMDg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNjEuOTk0IiB4PSIxNTMyIiB5PSIxMjYuNzg1MSI+aW5mcmFzdHJ1Y3R1cmUmIzY1Mjg4O091dHB1dCBBZGFwdGVyJiM2NTI4OTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgY29udHJvbGxlci0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImluZnJhc3RydWN0dXJlLklucHV0IEFkYXB0ZXIuLmNvbnRyb2xsZXIiIGRhdGEtc291cmNlLWxpbmU9IjQiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIxNC4zNTk0IiB4PSIxMjY0LjgyIiB5PSIxNDYuNzkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTQuMzU5NCIgeD0iMTI3NC44MiIgeT0iMTY5Ljc4NTEiPkluY29tZVN0YXRlbWVudENvbnRyb2xsZXI8L3RleHQ+PC9nPjwhLS1lbnRpdHkgSW5jb21lU3RhdGVtZW50VXNlQ2FzZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImFwcGxpY2F0aW9uLnBvcnQuaW4uSW5wdXQgUG9ydC4uSW5jb21lU3RhdGVtZW50VXNlQ2FzZSIgZGF0YS1zb3VyY2UtbGluZT0iOSIgaWQ9ImVudDAwMDYiPjxlbGxpcHNlIGN4PSI4MDQiIGN5PSIyODcuMDkiIGZpbGw9IiNGMUYxRjEiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg1LjYwMjUiIHg9IjcxMS4xOTg3IiB5PSIzMTcuMDg1MSI+SW5jb21lU3RhdGVtZW50VXNlQ2FzZTwvdGV4dD48L2c+PCEtLWVudGl0eSBJbmNvbWVTdGF0ZW1lbnRTZXJ2aWNlLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iYXBwbGljYXRpb24uc2VydmljZS5JbmNvbWVTdGF0ZW1lbnRTZXJ2aWNlIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgaWQ9ImVudDAwMDgiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTk2LjkyNzciIHg9IjcwNS41NCIgeT0iMTQ2Ljc5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc2LjkyNzciIHg9IjcxNS41NCIgeT0iMTY5Ljc4NTEiPkluY29tZVN0YXRlbWVudFNlcnZpY2U8L3RleHQ+PC9nPjwhLS1lbnRpdHkgSW5jb21lU3RhdGVtZW50UmVwb3NpdG9yeS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImFwcGxpY2F0aW9uLnBvcnQub3V0Lk91dHB1dCBQb3J0Li5JbmNvbWVTdGF0ZW1lbnRSZXBvc2l0b3J5IiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgaWQ9ImVudDAwMTAiPjxlbGxpcHNlIGN4PSIxMDY4IiBjeT0iMjg3LjA5IiBmaWxsPSIjRjFGMUYxIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIwMC4yNTg4IiB4PSI5NjcuODcwNiIgeT0iMzE3LjA4NTEiPkluY29tZVN0YXRlbWVudFJlcG9zaXRvcnk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgY2F0ZWdvcnktLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJkb21haW4ubW9kZWwuY2F0ZWdvcnkiIGRhdGEtc291cmNlLWxpbmU9IjIwIiBpZD0iZW50MDAxMiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDkuMTM2NyIgeD0iMjIuNDMiIHk9IjI2OC45NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4OS4xMzY3IiB4PSIzMi40MyIgeT0iMjkxLjkzNTEiPkluY29tZVN0YXRlbWVudENhdGVnb3J5PC90ZXh0PjwvZz48IS0tZW50aXR5IGl0ZW0tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJkb21haW4ubW9kZWwuaXRlbSIgZGF0YS1zb3VyY2UtbGluZT0iMjEiIGlkPSJlbnQwMDEzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE3Ny4wNTU3IiB4PSIyNjYuNDciIHk9IjI2OC45NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1Ny4wNTU3IiB4PSIyNzYuNDciIHk9IjI5MS45MzUxIj5JbmNvbWVTdGF0ZW1lbnRJdGVtPC90ZXh0PjwvZz48IS0tZW50aXR5IGluY29tZVN0YXRlbWVudC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImRvbWFpbi5tb2RlbC5pbmNvbWVTdGF0ZW1lbnQiIGRhdGEtc291cmNlLWxpbmU9IjIyIiBpZD0iZW50MDAxNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDUuMTg2NSIgeD0iNDc4LjQxIiB5PSIyNjguOTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjUuMTg2NSIgeD0iNDg4LjQxIiB5PSIyOTEuOTM1MSI+SW5jb21lU3RhdGVtZW50PC90ZXh0PjwvZz48IS0tZW50aXR5IHJlcG9JbXBsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iaW5mcmFzdHJ1Y3R1cmUuT3V0cHV0IEFkYXB0ZXIuLnJlcG9JbXBsIiBkYXRhLXNvdXJjZS1saW5lPSIyNiIgaWQ9ImVudDAwMTYiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMjUwLjgwMTgiIHg9IjE1NDMuNiIgeT0iMTQ2Ljc5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjMwLjgwMTgiIHg9IjE1NTMuNiIgeT0iMTY5Ljc4NTEiPkluY29tZVN0YXRlbWVudFJlcG9zaXRvcnlJbXBsPC90ZXh0PjwvZz48IS0tZW50aXR5IG1hcHBlci0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImluZnJhc3RydWN0dXJlLk91dHB1dCBBZGFwdGVyLi5tYXBwZXIiIGRhdGEtc291cmNlLWxpbmU9IjI3IiBpZD0iZW50MDAxNyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxOTcuOTg3MyIgeD0iMTU3MC4wMSIgeT0iMjY4Ljk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3Ljk4NzMiIHg9IjE1ODAuMDEiIHk9IjI5MS45MzUxIj5JbmNvbWVTdGF0ZW1lbnRNYXBwZXI8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IkdNTjI0IiBkYXRhLXNvdXJjZS1saW5lPSIzOCIgaWQ9ImVudDAwMjUiPjxwYXRoIGQ9Ik0xODI5Ljg2LDE0NC44MSBMMTgyOS44NiwxODUuMDc1NiBMMTk1Mi4xMzA2LDE4NS4wNzU2IEwxOTUyLjEzMDYsMTU0LjgxIEwxOTQyLjEzMDYsMTQ0LjgxIEwxODI5Ljg2LDE0NC44MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTE5NDIuMTMwNiwxNDQuODEgTDE5NDIuMTMwNiwxNTQuODEgTDE5NTIuMTMwNiwxNTQuODEgTDE5NDIuMTMwNiwxNDQuODEiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4OS41OTcyIiB4PSIxODM1Ljg2IiB5PSIxNjEuODc2OSI+SW5wdXQgQWRhcHRlcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDEuMjcwNiIgeD0iMTgzNS44NiIgeT0iMTc3LjAwOTciPlJFU1QgQVBJICYjMTI0MzQ7JiMyNTU1MjsmIzIwMzc5OzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iR01OMjciIGRhdGEtc291cmNlLWxpbmU9IjQzIiBpZD0iZW50MDAyOCI+PHBhdGggZD0iTTE5ODYuOCwxNDQuODEgTDE5ODYuOCwxODUuMDc1NiBMMjExNS4yMDg4LDE4NS4wNzU2IEwyMTE1LjIwODgsMTU0LjgxIEwyMTA1LjIwODgsMTQ0LjgxIEwxOTg2LjgsMTQ0LjgxIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMjEwNS4yMDg4LDE0NC44MSBMMjEwNS4yMDg4LDE1NC44MSBMMjExNS4yMDg4LDE1NC44MSBMMjEwNS4yMDg4LDE0NC44MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMS4wOTI4IiB4PSIxOTkyLjgiIHk9IjE2MS44NzY5Ij5PdXRwdXQgQWRhcHRlcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDcuNDA4OCIgeD0iMTk5Mi44IiB5PSIxNzcuMDA5NyI+TXlCYXRpcyAmIzEyMzkxOyYjMjc3MDQ7JiMzMjE1NDsmIzIxMjcwOzwvdGV4dD48L2c+PCEtLWxpbmsgY29udHJvbGxlciB0byBJbmNvbWVTdGF0ZW1lbnRVc2VDYXNlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDMiIGRhdGEtZW50aXR5LTI9ImVudDAwMDYiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIzMCIgaWQ9ImxuazE4Ij48cGF0aCBkPSJNMTI2NC4zNSwxNjcuOCBDMTE3Ni41LDE3MS43OSAxMDUwLjAxLDE4My4yNCA5NDQsMjE1LjA5IEM4OTEuMDIsMjMxLjAxIDgzOS4wNTI1LDI2My4wNDc2IDgxNy43MjI1LDI3Ni45ODc2IiBmaWxsPSJub25lIiBpZD0iY29udHJvbGxlci10by1JbmNvbWVTdGF0ZW1lbnRVc2VDYXNlIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI4MTIuNywyODAuMjcsODIyLjQyMjEsMjc4LjY5NDcsODE2Ljg4NTQsMjc3LjUzNDcsODE4LjA0NTUsMjcxLjk5OCw4MTIuNywyODAuMjciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgSW5jb21lU3RhdGVtZW50U2VydmljZSB0byBJbmNvbWVTdGF0ZW1lbnRVc2VDYXNlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDgiIGRhdGEtZW50aXR5LTI9ImVudDAwMDYiIGRhdGEtbGluay10eXBlPSJleHRlbnNpb24iIGRhdGEtc291cmNlLWxpbmU9IjMxIiBpZD0ibG5rMTkiPjxwYXRoIGQ9Ik04MDQsMTgzLjQxIEM4MDQsMjA5Ljg0IDgwNCwyNDAuOTIgODA0LDI2MC4xMSIgZmlsbD0ibm9uZSIgaWQ9IkluY29tZVN0YXRlbWVudFNlcnZpY2UtdG8tSW5jb21lU3RhdGVtZW50VXNlQ2FzZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iODA0LDI3OC4xMSw4MTAsMjYwLjExLDc5OCwyNjAuMTEsODA0LDI3OC4xMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBJbmNvbWVTdGF0ZW1lbnRTZXJ2aWNlIHRvIEluY29tZVN0YXRlbWVudFJlcG9zaXRvcnktLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwOCIgZGF0YS1lbnRpdHktMj0iZW50MDAxMCIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjMyIiBpZD0ibG5rMjAiPjxwYXRoIGQ9Ik04NDYuOSwxODMuNTYgQzg2OC44NywxOTIuNzIgODk1Ljk4LDIwNC4yNSA5MjAsMjE1LjA5IEM5NzMuMjUsMjM5LjEzIDEwMzAuNzQ4OCwyNjcuNTI2MSAxMDUzLjY4ODgsMjc4Ljk0NjEiIGZpbGw9Im5vbmUiIGlkPSJJbmNvbWVTdGF0ZW1lbnRTZXJ2aWNlLXRvLUluY29tZVN0YXRlbWVudFJlcG9zaXRvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEwNTkuMDYsMjgxLjYyLDEwNTIuNzg1OCwyNzQuMDI4MywxMDU0LjU4NCwyNzkuMzkxNywxMDQ5LjIyMDUsMjgxLjE5LDEwNTkuMDYsMjgxLjYyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIEluY29tZVN0YXRlbWVudFNlcnZpY2UgdG8gaW5jb21lU3RhdGVtZW50LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDgiIGRhdGEtZW50aXR5LTI9ImVudDAwMTQiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIzMyIgaWQ9ImxuazIxIj48cGF0aCBkPSJNNzYwLjEzLDE4My41OSBDNzM4LjI4LDE5Mi42MiA3MTEuNTUsMjA0LjAyIDY4OCwyMTUuMDkgQzY1MS42MywyMzIuMTkgNjE2LjEzMjgsMjUwLjc3NTMgNTg4LjU5MjgsMjY1LjYwNTMiIGZpbGw9Im5vbmUiIGlkPSJJbmNvbWVTdGF0ZW1lbnRTZXJ2aWNlLXRvLWluY29tZVN0YXRlbWVudCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNTgzLjMxLDI2OC40NSw1OTMuMTMwNiwyNjcuNzA0OCw1ODcuNzEyMywyNjYuMDc5NCw1ODkuMzM3NywyNjAuNjYxMSw1ODMuMzEsMjY4LjQ1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHJlcG9JbXBsIHRvIEluY29tZVN0YXRlbWVudFJlcG9zaXRvcnktLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAxNiIgZGF0YS1lbnRpdHktMj0iZW50MDAxMCIgZGF0YS1saW5rLXR5cGU9ImV4dGVuc2lvbiIgZGF0YS1zb3VyY2UtbGluZT0iMzQiIGlkPSJsbmsyMiI+PHBhdGggZD0iTTE1OTguMDcsMTgzLjU1IEMxNTY2LjU4LDE5MS4xNSAxNTI5LjAyLDE5OS45MiAxNDk1LDIwNy4wOSBDMTMyNy41NCwyNDIuMzYgMTEzOS4wNzQzLDI3NC4yMzYzIDEwOTQuNTA0MywyODEuNjc2MyIgZmlsbD0ibm9uZSIgaWQ9InJlcG9JbXBsLXRvLUluY29tZVN0YXRlbWVudFJlcG9zaXRvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjEwNzYuNzUsMjg0LjY0LDEwOTUuNDkyMiwyODcuNTk0NCwxMDkzLjUxNjQsMjc1Ljc1ODIsMTA3Ni43NSwyODQuNjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcmVwb0ltcGwgdG8gbWFwcGVyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMTYiIGRhdGEtZW50aXR5LTI9ImVudDAwMTciIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIzNSIgaWQ9ImxuazIzIj48cGF0aCBkPSJNMTY2OSwxODMuNDEgQzE2NjksMjA2LjE5IDE2NjksMjM5LjgxIDE2NjksMjYyLjYiIGZpbGw9Im5vbmUiIGlkPSJyZXBvSW1wbC10by1tYXBwZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE2NjksMjY4LjYsMTY3MywyNTkuNiwxNjY5LDI2My42LDE2NjUsMjU5LjYsMTY2OSwyNjguNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBjb250cm9sbGVyIHRvIEdNTjI0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDMiIGRhdGEtZW50aXR5LTI9ImVudDAwMjUiIGRhdGEtbGluay10eXBlPSJhc3NvY2lhdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iMzgiIGlkPSJsbmsyNiI+PHBhdGggZD0iTTEzODcuODgsMTQ2LjQ3IEMxNDE1Ljk0LDExNS40MyAxNDc3Ljc2LDUzLjkzIDE1NDUuNSwzMC43OSBDMTU5Ny40NCwxMy4wNSAxNzQzLjUzLDYgMTc5Mi41LDMwLjc5IEMxODM5LjgsNTQuNzQgMTg2OS45LDExMy4yOCAxODgzLjE2LDE0NC41MiIgZmlsbD0ibm9uZSIgaWQ9ImNvbnRyb2xsZXItR01OMjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48L2c+PCEtLWxpbmsgcmVwb0ltcGwgdG8gR01OMjctLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAxNiIgZGF0YS1lbnRpdHktMj0iZW50MDAyOCIgZGF0YS1saW5rLXR5cGU9ImFzc29jaWF0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI0MyIgaWQ9ImxuazI5Ij48cGF0aCBkPSJNMTY4My4zNywxNDYuNSBDMTcwOC44NSwxMTUuNTEgMTc2NS4zMiw1NC4wOCAxODI5LjUsMzAuNzkgQzE4ODAuODksMTIuMTUgMTkwMy43Myw2LjEgMTk1Mi41LDMwLjc5IEMxOTk5LjgsNTQuNzQgMjAyOS45LDExMy4yOCAyMDQzLjE2LDE0NC41MiIgZmlsbD0ibm9uZSIgaWQ9InJlcG9JbXBsLUdNTjI3IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheTo3LDc7Ii8+PC9nPjw/cGxhbnR1bWwtc3JjIGJMRXpKaUNtNER4ejU1UnR2WDZHSWlNR2VROWdPNDhUaEVHUWgyUXNQSmo4NUozMEwyR2E0MEMzRjAwaDRzQWVVOWIyNlZpQU5EOHFKUGZHbU1KVnRfVlR0TVVSQ0hVQVFIUEpOeVBBMlgzTWl2QzhnMFJWQ1g1Nkc4WFlfZlk1RzVqU1ozR3BMWVUtSkpHaVByRE5nQ0pJSmkySzFSc1N0UkplRUpibjFLQTFQdmM1NkU2d0tiV2plbVpxYTNBM0Q2a0pOOVFXY0w4SHp2ZGJLZ0dXWEx6OVJIcWsyZ3Utc1phSDVxV3dPWnhHQlNQWjBycmMwRjRCNjBGd1pGbEdyOS10Mld0QndIY2hKOTFmVWZaT2xfOEVHNGQzaFRHSm4yZUY1eVlPU1U3NENlMmVTS0x1WGJZc01iMWtyQjlTRkI4Q1pmVFFUMU1mLVlmRHJDSkI5emtqdGNPY0RyUEhIZ0JIYkhncnQxd0FjQWlTUHpVS1Z3Q3RSUlZ0VmZFZ01IRmdFMVZfQk1hV0FVY29lc1h4VC1pbjZ2aWVHSFB2QUtXLURuN0l1WFZZdVFjYlNiSC15dktWR21PN3RYN2p6NXF3bHR2T3REcl9WWm1KNDA1RGd4U25ZZ3JOUElFem9KeC02YUZkTG8tQnJfVmxqd1Vsc3lTMnYwUzA/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_4">パッケージ構成<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>com.example.accounting/
├── domain/
│   └── model/
│       └── financial/
│           ├── IncomeStatementCategory.java  # 損益計算書区分
│           ├── IncomeStatementItem.java      # 損益計算書項目
│           └── IncomeStatement.java          # 損益計算書
├── application/
│   ├── port/
│   │   ├── in/
│   │   │   └── IncomeStatementUseCase.java   # Input Port
│   │   └── out/
│   │       └── IncomeStatementRepository.java # Output Port
│   └── service/
│       └── IncomeStatementService.java       # Application Service
└── infrastructure/
    ├── persistence/
    │   ├── mapper/
    │   │   └── IncomeStatementMapper.java    # MyBatis Mapper
    │   └── repository/
    │       └── IncomeStatementRepositoryImpl.java  # Output Adapter
    └── web/
        ├── controller/
        │   └── IncomeStatementController.java # Input Adapter
        └── dto/
            └── IncomeStatementResponse.java
</code></pre></div>
<h3 id="tdd">TDD の流れ<a class="headerlink" href="#tdd" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Domain Model</strong>: ドメインモデルの作成（IncomeStatementCategory, IncomeStatementItem, IncomeStatement）</li>
<li><strong>Output Port</strong>: リポジトリインターフェースの定義</li>
<li><strong>Output Adapter</strong>: Testcontainers でリポジトリ実装をテスト</li>
<li><strong>Input Port</strong>: ユースケースインターフェースの定義</li>
<li><strong>Application Service</strong>: Mockito でアプリケーションサービスをテスト</li>
<li><strong>Input Adapter</strong>: Testcontainers で REST API 統合テスト</li>
</ol>
<hr />
<h2 id="202-domain-model">20.2 Domain Model の実装<a class="headerlink" href="#202-domain-model" title="Permanent link">&para;</a></h2>
<h3 id="2021-incomestatementcategory">20.2.1 IncomeStatementCategory 列挙型<a class="headerlink" href="#2021-incomestatementcategory" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書区分</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 収益</span>
<span class="w">    </span><span class="n">SALES</span><span class="p">(</span><span class="s">&quot;売上高&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;41&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;収益&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">    </span><span class="n">NON_OPERATING_REVENUE</span><span class="p">(</span><span class="s">&quot;営業外収益&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;42&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;収益&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">    </span><span class="n">EXTRAORDINARY_INCOME</span><span class="p">(</span><span class="s">&quot;特別利益&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;43&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;収益&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>

<span class="w">    </span><span class="c1">// 費用</span>
<span class="w">    </span><span class="n">COST_OF_SALES</span><span class="p">(</span><span class="s">&quot;売上原価&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;51&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">    </span><span class="n">SELLING_GENERAL_ADMIN</span><span class="p">(</span><span class="s">&quot;販売費及び一般管理費&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;52&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">    </span><span class="n">NON_OPERATING_EXPENSE</span><span class="p">(</span><span class="s">&quot;営業外費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;61&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">    </span><span class="n">EXTRAORDINARY_LOSS</span><span class="p">(</span><span class="s">&quot;特別損失&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;62&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">    </span><span class="n">INCOME_TAXES</span><span class="p">(</span><span class="s">&quot;法人税等&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;71&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;費用&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">codePrefix</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">sectionName</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isRevenue</span><span class="p">;</span>

<span class="w">    </span><span class="n">IncomeStatementCategory</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">codePrefix</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">sectionName</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isRevenue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">displayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">codePrefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">codePrefix</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">sectionName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sectionName</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">isRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isRevenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getDisplayName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getCodePrefix</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">codePrefix</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getSectionName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sectionName</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 収益区分か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRevenue</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRevenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 費用区分か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isExpense</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">isRevenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 売上原価か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isCostOfSales</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">COST_OF_SALES</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 販管費か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSellingGeneralAdmin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SELLING_GENERAL_ADMIN</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 営業外項目か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isNonOperating</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NON_OPERATING_REVENUE</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NON_OPERATING_EXPENSE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 特別項目か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isExtraordinary</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EXTRAORDINARY_INCOME</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EXTRAORDINARY_LOSS</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目コードから区分を判定</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="nf">fromAccountCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">accountCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">accountCode</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Invalid account code: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">accountCode</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountCode</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefix</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">codePrefix</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// 範囲による判定</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">prefix</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">41</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">41</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">SALES</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">NON_OPERATING_REVENUE</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">49</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">EXTRAORDINARY_INCOME</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">51</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">51</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">COST_OF_SALES</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">52</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">59</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">SELLING_GENERAL_ADMIN</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">61</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">61</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">NON_OPERATING_EXPENSE</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">62</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">69</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">EXTRAORDINARY_LOSS</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">prefixNum</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">79</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">INCOME_TAXES</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unknown P/L category for account code: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">accountCode</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2022-incomestatementitem">20.2.2 IncomeStatementItem ドメインモデル<a class="headerlink" href="#2022-incomestatementitem" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Value</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.With</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.RoundingMode</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書項目</span>
<span class="cm"> */</span>
<span class="nd">@Value</span>
<span class="nd">@With</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementItem</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">;</span><span class="w">                   </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">accountName</span><span class="p">;</span><span class="w">                   </span><span class="c1">// 勘定科目名</span>
<span class="w">    </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">category</span><span class="p">;</span><span class="w">     </span><span class="c1">// 区分</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span><span class="w">                    </span><span class="c1">// 金額</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">percentage</span><span class="p">;</span><span class="w">                </span><span class="c1">// 対売上高比率（%）</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 残高データから損益計算書項目を作成</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">accountName</span><span class="p">,</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">,</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="p">,</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">fromAccountCode</span><span class="p">(</span><span class="n">accountCode</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 収益は貸方 - 借方、費用は借方 - 貸方</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;貸&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">debitCreditType</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 収益科目: 貸方 - 借方</span>
<span class="w">            </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creditTotal</span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">debitTotal</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 費用科目: 借方 - 貸方</span>
<span class="w">            </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">creditTotal</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">(</span>
<span class="w">                </span><span class="n">accountCode</span><span class="p">,</span>
<span class="w">                </span><span class="n">accountName</span><span class="p">,</span>
<span class="w">                </span><span class="n">category</span><span class="p">,</span>
<span class="w">                </span><span class="n">amount</span><span class="p">.</span><span class="na">abs</span><span class="p">(),</span>
<span class="w">                </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">);</span><span class="w"> </span><span class="c1">// 比率は後で計算</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 対売上高比率を計算して新しいインスタンスを返す</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="nf">withPercentage</span><span class="p">(</span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalSales</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">amount</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="n">pct</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 収益項目か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRevenue</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="p">.</span><span class="na">isRevenue</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 費用項目か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isExpense</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="p">.</span><span class="na">isExpense</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 売上高か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSales</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">SALES</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 売上原価か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isCostOfSales</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="p">.</span><span class="na">isCostOfSales</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 販管費か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSellingGeneralAdmin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="p">.</span><span class="na">isSellingGeneralAdmin</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 営業外収益か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isNonOperatingRevenue</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">NON_OPERATING_REVENUE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 営業外費用か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isNonOperatingExpense</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">NON_OPERATING_EXPENSE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 特別利益か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isExtraordinaryIncome</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">EXTRAORDINARY_INCOME</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 特別損失か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isExtraordinaryLoss</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">EXTRAORDINARY_LOSS</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 法人税等か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isIncomeTaxes</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">INCOME_TAXES</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2023-incomestatement">20.2.3 IncomeStatement ドメインモデル<a class="headerlink" href="#2023-incomestatement" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Value</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.With</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.RoundingMode</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書ドメインモデル</span>
<span class="cm"> */</span>
<span class="nd">@Value</span>
<span class="nd">@With</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatement</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">;</span><span class="w">                        </span><span class="c1">// 開始日</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">;</span><span class="w">                          </span><span class="c1">// 終了日</span>
<span class="w">    </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">;</span><span class="w">                        </span><span class="c1">// 会計年度</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">revenues</span><span class="p">;</span><span class="w">        </span><span class="c1">// 収益項目</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">expenses</span><span class="p">;</span><span class="w">        </span><span class="c1">// 費用項目</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalSales</span><span class="p">;</span><span class="w">                     </span><span class="c1">// 売上高合計</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalRevenues</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 収益合計</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalExpenses</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 費用合計</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfit</span><span class="p">;</span><span class="w">                    </span><span class="c1">// 売上総利益</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingIncome</span><span class="p">;</span><span class="w">                </span><span class="c1">// 営業利益</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">ordinaryIncome</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 経常利益</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">incomeBeforeTaxes</span><span class="p">;</span><span class="w">              </span><span class="c1">// 税引前当期純利益</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">netIncome</span><span class="p">;</span><span class="w">                      </span><span class="c1">// 当期純利益</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 残高データから損益計算書を作成</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// 収益・費用に分類</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">revenueItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isRevenue</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">expenseItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isExpense</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>

<span class="w">        </span><span class="c1">// 売上高</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalSales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isSales</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 売上原価</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">costOfSales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isCostOfSales</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 販管費</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">sellingGeneralAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isSellingGeneralAdmin</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 営業外収益</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">nonOperatingRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isNonOperatingRevenue</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 営業外費用</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">nonOperatingExpense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isNonOperatingExpense</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 特別利益</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">extraordinaryIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isExtraordinaryIncome</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 特別損失</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">extraordinaryLoss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isExtraordinaryLoss</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 法人税等</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">incomeTaxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isIncomeTaxes</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 収益合計・費用合計</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalRevenues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">revenueItems</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalExpenses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expenseItems</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 利益計算</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalSales</span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">costOfSales</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grossProfit</span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">sellingGeneralAdmin</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">ordinaryIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">operatingIncome</span>
<span class="w">                </span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">nonOperatingRevenue</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">nonOperatingExpense</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">incomeBeforeTaxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ordinaryIncome</span>
<span class="w">                </span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">extraordinaryIncome</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">extraordinaryLoss</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">netIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeBeforeTaxes</span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">incomeTaxes</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 対売上高比率を計算</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">revenuesWithPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">revenueItems</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="n">totalSales</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">expensesWithPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expenseItems</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="n">totalSales</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">(</span>
<span class="w">                </span><span class="n">fromDate</span><span class="p">,</span>
<span class="w">                </span><span class="n">toDate</span><span class="p">,</span>
<span class="w">                </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">                </span><span class="n">revenuesWithPercentage</span><span class="p">,</span>
<span class="w">                </span><span class="n">expensesWithPercentage</span><span class="p">,</span>
<span class="w">                </span><span class="n">totalSales</span><span class="p">,</span>
<span class="w">                </span><span class="n">totalRevenues</span><span class="p">,</span>
<span class="w">                </span><span class="n">totalExpenses</span><span class="p">,</span>
<span class="w">                </span><span class="n">grossProfit</span><span class="p">,</span>
<span class="w">                </span><span class="n">operatingIncome</span><span class="p">,</span>
<span class="w">                </span><span class="n">ordinaryIncome</span><span class="p">,</span>
<span class="w">                </span><span class="n">incomeBeforeTaxes</span><span class="p">,</span>
<span class="w">                </span><span class="n">netIncome</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 売上総利益率を計算（売上総利益 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getGrossProfitMargin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">grossProfit</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 営業利益率を計算（営業利益 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getOperatingProfitMargin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">operatingIncome</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 経常利益率を計算（経常利益 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getOrdinaryProfitMargin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ordinaryIncome</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 当期純利益率を計算（当期純利益 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getNetProfitMargin</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">netIncome</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 売上原価率を計算（売上原価 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getCostOfSalesRatio</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">costOfSales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expenses</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isCostOfSales</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">costOfSales</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 販管費比率を計算（販管費 ÷ 売上高 × 100）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getSgaRatio</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalSales</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">sga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expenses</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isSellingGeneralAdmin</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sga</span>
<span class="w">                </span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="n">totalSales</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 黒字か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isProfitable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">netIncome</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 赤字か</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isDeficit</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">netIncome</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="203-domain-model">20.3 Domain Model のテスト<a class="headerlink" href="#203-domain-model" title="Permanent link">&para;</a></h2>
<h3 id="2031-incomestatementcategory">20.3.1 IncomeStatementCategory のテスト<a class="headerlink" href="#2031-incomestatementcategory" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.params.provider.CsvSource</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThat</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThatThrownBy</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatementCategory（損益計算書区分）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementCategoryTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目コードからの区分判定&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">FromAccountCode</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@ParameterizedTest</span>
<span class="w">        </span><span class="nd">@CsvSource</span><span class="p">({</span>
<span class="w">            </span><span class="s">&quot;4110, SALES, 売上高&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;4210, NON_OPERATING_REVENUE, 営業外収益&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;4310, EXTRAORDINARY_INCOME, 特別利益&quot;</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;収益科目を正しく判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_収益科目の判定</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">expected</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">fromAccountCode</span><span class="p">(</span><span class="n">accountCode</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">expected</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">displayName</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">isRevenue</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">isExpense</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@ParameterizedTest</span>
<span class="w">        </span><span class="nd">@CsvSource</span><span class="p">({</span>
<span class="w">            </span><span class="s">&quot;5110, COST_OF_SALES, 売上原価&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;5210, SELLING_GENERAL_ADMIN, 販売費及び一般管理費&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;6110, NON_OPERATING_EXPENSE, 営業外費用&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;6210, EXTRAORDINARY_LOSS, 特別損失&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;7110, INCOME_TAXES, 法人税等&quot;</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;費用科目を正しく判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_費用科目の判定</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">expected</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementCategory</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">fromAccountCode</span><span class="p">(</span><span class="n">accountCode</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">expected</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">displayName</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">isRevenue</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">category</span><span class="p">.</span><span class="na">isExpense</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;不正な勘定科目コードは例外をスロー&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_不正な勘定科目コード</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">fromAccountCode</span><span class="p">(</span><span class="s">&quot;1110&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">fromAccountCode</span><span class="p">(</span><span class="kc">null</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;区分判定メソッド&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">CategoryJudgment</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;売上原価・販管費を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_費用区分の判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">COST_OF_SALES</span><span class="p">.</span><span class="na">isCostOfSales</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">SELLING_GENERAL_ADMIN</span><span class="p">.</span><span class="na">isSellingGeneralAdmin</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;営業外項目を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_営業外項目の判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">NON_OPERATING_REVENUE</span><span class="p">.</span><span class="na">isNonOperating</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">NON_OPERATING_EXPENSE</span><span class="p">.</span><span class="na">isNonOperating</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">SALES</span><span class="p">.</span><span class="na">isNonOperating</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;特別項目を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_特別項目の判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">EXTRAORDINARY_INCOME</span><span class="p">.</span><span class="na">isExtraordinary</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">EXTRAORDINARY_LOSS</span><span class="p">.</span><span class="na">isExtraordinary</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">IncomeStatementCategory</span><span class="p">.</span><span class="na">SALES</span><span class="p">.</span><span class="na">isExtraordinary</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2032-incomestatementitem">20.3.2 IncomeStatementItem のテスト<a class="headerlink" href="#2032-incomestatementitem" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThat</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatementItem（損益計算書項目）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementItemTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;金額計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">AmountCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;収益科目（貸方）の金額を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_収益科目の金額計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given: 売上高 借方0 貸方1,000,000</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000000&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">,</span><span class="w"> </span><span class="n">creditTotal</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then: 金額 = 1,000,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;1000000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">isRevenue</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">isSales</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;費用科目（借方）の金額を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_費用科目の金額計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given: 仕入高 借方600,000 貸方0</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;600000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">,</span><span class="w"> </span><span class="n">creditTotal</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then: 金額 = 600,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;600000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">isExpense</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">isCostOfSales</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;販管費の金額を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_販管費の金額計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given: 給与手当 借方200,000 貸方0</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;200000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;5210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;給与手当&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">,</span><span class="w"> </span><span class="n">creditTotal</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;200000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">isSellingGeneralAdmin</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;対売上高比率計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">PercentageCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;対売上高比率を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_対売上高比率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given: 金額 300,000 / 売上高 1,000,000</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;300000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">itemWithPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000000&quot;</span><span class="p">));</span>

<span class="w">            </span><span class="c1">// Then: 対売上高比率 = 30.00%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">itemWithPercentage</span><span class="p">.</span><span class="na">getPercentage</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;30.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;売上高ゼロの場合は比率ゼロ&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_売上高ゼロの場合</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">itemWithPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">withPercentage</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">itemWithPercentage</span><span class="p">.</span><span class="na">getPercentage</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;区分判定&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">CategoryJudgment</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;営業外収益・費用を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_営業外項目の判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">nonOpRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;4210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;受取利息&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">nonOpExpense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;6110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;支払利息&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;5000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">nonOpRevenue</span><span class="p">.</span><span class="na">isNonOperatingRevenue</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">nonOpExpense</span><span class="p">.</span><span class="na">isNonOperatingExpense</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;特別利益・損失を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_特別項目の判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">extraIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;4310&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;固定資産売却益&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;50000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">extraLoss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;6210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;固定資産売却損&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;30000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">extraIncome</span><span class="p">.</span><span class="na">isExtraordinaryIncome</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">extraLoss</span><span class="p">.</span><span class="na">isExtraordinaryLoss</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2033-incomestatement">20.3.3 IncomeStatement のテスト<a class="headerlink" href="#2033-incomestatement" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThat</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatement（損益計算書）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;損益計算書の作成&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">CreateIncomeStatement</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;残高データから損益計算書を作成できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_損益計算書の作成</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                    </span><span class="c1">// 売上高: 1,000,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 売上原価: 600,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;600000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 販管費: 200,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;給与手当&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;200000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">),</span>
<span class="w">                    </span><span class="mi">2024</span><span class="p">,</span>
<span class="w">                    </span><span class="n">items</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getFromDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getToDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getFiscalYear</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2024</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getRevenues</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getExpenses</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;利益計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ProfitCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">createSampleIncomeStatement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                    </span><span class="c1">// 売上高: 10,000,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 売上原価: 6,000,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;6000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 販管費: 2,000,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;給与手当&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;2000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 営業外収益: 100,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;受取利息&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 営業外費用: 50,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;6110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;支払利息&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;50000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 特別利益: 200,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4310&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;固定資産売却益&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;200000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 特別損失: 100,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;6210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;固定資産売却損&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="c1">// 法人税等: 600,000</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;7110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;法人税等&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;600000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">),</span>
<span class="w">                    </span><span class="mi">2024</span><span class="p">,</span>
<span class="w">                    </span><span class="n">items</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;売上総利益を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_売上総利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 売上総利益 = 売上高 - 売上原価</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getGrossProfit</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 10,000,000 - 6,000,000 = 4,000,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">grossProfit</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;4000000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;営業利益を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_営業利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 営業利益 = 売上総利益 - 販管費</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOperatingIncome</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 4,000,000 - 2,000,000 = 2,000,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">operatingIncome</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2000000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;経常利益を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_経常利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 経常利益 = 営業利益 + 営業外収益 - 営業外費用</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">ordinaryIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOrdinaryIncome</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 2,000,000 + 100,000 - 50,000 = 2,050,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">ordinaryIncome</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2050000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;税引前当期純利益を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_税引前当期純利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 税引前当期純利益 = 経常利益 + 特別利益 - 特別損失</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">incomeBeforeTaxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getIncomeBeforeTaxes</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 2,050,000 + 200,000 - 100,000 = 2,150,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeBeforeTaxes</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2150000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;当期純利益を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_当期純利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 当期純利益 = 税引前当期純利益 - 法人税等</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">netIncome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getNetIncome</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 2,150,000 - 600,000 = 1,550,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">netIncome</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;1550000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;利益率計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ProfitMarginCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">createSampleIncomeStatement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;6000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;給与手当&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;2000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">),</span>
<span class="w">                    </span><span class="mi">2024</span><span class="p">,</span>
<span class="w">                    </span><span class="n">items</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;売上総利益率を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_売上総利益率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 売上総利益率 = 売上総利益 / 売上高 × 100</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfitMargin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getGrossProfitMargin</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 4,000,000 / 10,000,000 × 100 = 40%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">grossProfitMargin</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;40.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;営業利益率を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_営業利益率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 営業利益率 = 営業利益 / 売上高 × 100</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingProfitMargin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOperatingProfitMargin</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 2,000,000 / 10,000,000 × 100 = 20%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">operatingProfitMargin</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;20.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;売上原価率を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_売上原価率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 売上原価率 = 売上原価 / 売上高 × 100</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">costOfSalesRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getCostOfSalesRatio</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 6,000,000 / 10,000,000 × 100 = 60%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">costOfSalesRatio</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;60.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;販管費比率を計算できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_販管費比率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSampleIncomeStatement</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// When: 販管費比率 = 販管費 / 売上高 × 100</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">sgaRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getSgaRatio</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Then: 2,000,000 / 10,000,000 × 100 = 20%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">sgaRatio</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;20.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;黒字・赤字判定&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ProfitabilityJudgment</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;黒字を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_黒字判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;600000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">),</span><span class="w"> </span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">isProfitable</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">isDeficit</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;赤字を判定できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_赤字判定</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;500000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;800000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">),</span><span class="w"> </span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">isProfitable</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">isDeficit</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="204-output-port">20.4 Output Port の定義<a class="headerlink" href="#204-output-port" title="Permanent link">&para;</a></h2>
<h3 id="2041-incomestatementrepository">20.4.1 IncomeStatementRepository インターフェース<a class="headerlink" href="#2041-incomestatementrepository" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.out</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書リポジトリ（Output Port）</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">IncomeStatementRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定期間の P/L 科目残高を取得</span>
<span class="cm">     *</span>
<span class="cm">     * @param fromDate 開始日</span>
<span class="cm">     * @param toDate   終了日</span>
<span class="cm">     * @return 損益計算書項目リスト</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPeriod</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定会計年度の P/L 科目残高を取得</span>
<span class="cm">     *</span>
<span class="cm">     * @param fiscalYear 会計年度</span>
<span class="cm">     * @return 損益計算書項目リスト</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByFiscalYear</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 月次損益を取得</span>
<span class="cm">     *</span>
<span class="cm">     * @param fiscalYear 会計年度</span>
<span class="cm">     * @param month      月（1-12）</span>
<span class="cm">     * @return 損益計算書項目リスト</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByMonth</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="205-output-adapter">20.5 Output Adapter の実装<a class="headerlink" href="#205-output-adapter" title="Permanent link">&para;</a></h2>
<h3 id="2051-incomestatementmapper">20.5.1 IncomeStatementMapper インターフェース<a class="headerlink" href="#2051-incomestatementmapper" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書 MyBatis Mapper</span>
<span class="cm"> */</span>
<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">IncomeStatementMapper</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定期間の P/L 科目残高を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">selectByPeriod</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;fromDate&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;toDate&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定会計年度の P/L 科目残高を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">selectByFiscalYear</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;fiscalYear&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 月次損益を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">selectByMonth</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;fiscalYear&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;month&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2052-mybatis-mapper-xml">20.5.2 MyBatis Mapper XML<a class="headerlink" href="#2052-mybatis-mapper-xml" title="Permanent link">&para;</a></h3>
<p><code>src/main/resources/mapper/IncomeStatementMapper.xml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>

<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.accounting.infrastructure.persistence.mapper.IncomeStatementMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- P/L科目残高クエリ --&gt;</span>
<span class="w">    </span><span class="nt">&lt;sql</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;incomeStatementBase&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT
<span class="w">            </span>a.&quot;勘定科目コード&quot;<span class="w"> </span>as<span class="w"> </span>account_code,
<span class="w">            </span>a.&quot;勘定科目名&quot;<span class="w"> </span>as<span class="w"> </span>account_name,
<span class="w">            </span>a.&quot;貸借区分&quot;<span class="w"> </span>as<span class="w"> </span>debit_credit_type,
<span class="w">            </span>COALESCE(SUM(d.&quot;借方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>as<span class="w"> </span>debit_total,
<span class="w">            </span>COALESCE(SUM(d.&quot;貸方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>as<span class="w"> </span>credit_total
<span class="w">        </span>FROM<span class="w"> </span>&quot;勘定科目マスタ&quot;<span class="w"> </span>a
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;日次勘定科目残高&quot;<span class="w"> </span>d
<span class="w">            </span>ON<span class="w"> </span>a.&quot;勘定科目コード&quot;<span class="w"> </span>=<span class="w"> </span>d.&quot;勘定科目コード&quot;
<span class="w">        </span>WHERE<span class="w"> </span>a.&quot;BSPL区分&quot;<span class="w"> </span>=<span class="w"> </span>&#39;P&#39;
<span class="w">    </span><span class="nt">&lt;/sql&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 指定期間の残高 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;selectByPeriod&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;map&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;include</span><span class="w"> </span><span class="na">refid=</span><span class="s">&quot;incomeStatementBase&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span>AND<span class="w"> </span>d.&quot;起票日&quot;<span class="w"> </span>BETWEEN<span class="w"> </span>#{fromDate}<span class="w"> </span>AND<span class="w"> </span>#{toDate}
<span class="w">        </span>GROUP<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;,<span class="w"> </span>a.&quot;勘定科目名&quot;,<span class="w"> </span>a.&quot;貸借区分&quot;
<span class="w">        </span>HAVING<span class="w"> </span>COALESCE(SUM(d.&quot;借方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">            </span>OR<span class="w"> </span>COALESCE(SUM(d.&quot;貸方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 指定会計年度の残高 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;selectByFiscalYear&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;map&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;include</span><span class="w"> </span><span class="na">refid=</span><span class="s">&quot;incomeStatementBase&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span>AND<span class="w"> </span>d.&quot;起票日&quot;<span class="w"> </span>BETWEEN<span class="w"> </span>MAKE_DATE(#{fiscalYear},<span class="w"> </span>4,<span class="w"> </span>1)<span class="w"> </span>AND<span class="w"> </span>MAKE_DATE(#{fiscalYear}<span class="w"> </span>+<span class="w"> </span>1,<span class="w"> </span>3,<span class="w"> </span>31)
<span class="w">        </span>GROUP<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;,<span class="w"> </span>a.&quot;勘定科目名&quot;,<span class="w"> </span>a.&quot;貸借区分&quot;
<span class="w">        </span>HAVING<span class="w"> </span>COALESCE(SUM(d.&quot;借方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">            </span>OR<span class="w"> </span>COALESCE(SUM(d.&quot;貸方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 月次損益 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;selectByMonth&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;map&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;include</span><span class="w"> </span><span class="na">refid=</span><span class="s">&quot;incomeStatementBase&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span>AND<span class="w"> </span>EXTRACT(YEAR<span class="w"> </span>FROM<span class="w"> </span>d.&quot;起票日&quot;)<span class="w"> </span>=<span class="w"> </span>CASE
<span class="w">                </span>WHEN<span class="w"> </span>#{month}<span class="w"> </span>&gt;=<span class="w"> </span>4<span class="w"> </span>THEN<span class="w"> </span>#{fiscalYear}
<span class="w">                </span>ELSE<span class="w"> </span>#{fiscalYear}<span class="w"> </span>+<span class="w"> </span>1
<span class="w">            </span>END
<span class="w">            </span>AND<span class="w"> </span>EXTRACT(MONTH<span class="w"> </span>FROM<span class="w"> </span>d.&quot;起票日&quot;)<span class="w"> </span>=<span class="w"> </span>#{month}
<span class="w">        </span>GROUP<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;,<span class="w"> </span>a.&quot;勘定科目名&quot;,<span class="w"> </span>a.&quot;貸借区分&quot;
<span class="w">        </span>HAVING<span class="w"> </span>COALESCE(SUM(d.&quot;借方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">            </span>OR<span class="w"> </span>COALESCE(SUM(d.&quot;貸方金額&quot;),<span class="w"> </span>0)<span class="w"> </span>!=<span class="w"> </span>0
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>a.&quot;勘定科目コード&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>
<h3 id="2053-incomestatementrepositoryimpl">20.5.3 IncomeStatementRepositoryImpl<a class="headerlink" href="#2053-incomestatementrepositoryimpl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.out.IncomeStatementRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.persistence.mapper.IncomeStatementMapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書リポジトリ実装（Output Adapter）</span>
<span class="cm"> */</span>
<span class="nd">@Repository</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IncomeStatementRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">IncomeStatementMapper</span><span class="w"> </span><span class="n">mapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPeriod</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">selectByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">mapToIncomeStatementItem</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByFiscalYear</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">selectByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">mapToIncomeStatementItem</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByMonth</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">selectByMonth</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">mapToIncomeStatementItem</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="nf">mapToIncomeStatementItem</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;account_code&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">accountName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;account_name&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">debitCreditType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;debit_credit_type&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">)</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;debit_total&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">)</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;credit_total&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span>
<span class="w">                </span><span class="n">accountCode</span><span class="p">,</span>
<span class="w">                </span><span class="n">accountName</span><span class="p">,</span>
<span class="w">                </span><span class="n">debitTotal</span><span class="p">,</span>
<span class="w">                </span><span class="n">creditTotal</span><span class="p">,</span>
<span class="w">                </span><span class="n">debitCreditType</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="206-output-adapter">20.6 Output Adapter のテスト<a class="headerlink" href="#206-output-adapter" title="Permanent link">&para;</a></h2>
<h3 id="2061-testcontainers">20.6.1 Testcontainers を使った統合テスト<a class="headerlink" href="#2061-testcontainers" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mybatis.spring.boot.test.autoconfigure.MybatisTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.jdbc.core.JdbcTemplate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertyRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertySource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.containers.PostgreSQLContainer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Container</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Testcontainers</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThat</span><span class="p">;</span>

<span class="nd">@MybatisTest</span>
<span class="nd">@Testcontainers</span>
<span class="nd">@AutoConfigureTestDatabase</span><span class="p">(</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AutoConfigureTestDatabase</span><span class="p">.</span><span class="na">Replace</span><span class="p">.</span><span class="na">NONE</span><span class="p">)</span>
<span class="nd">@Import</span><span class="p">(</span><span class="n">IncomeStatementRepositoryImpl</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatementRepositoryImpl（損益計算書リポジトリ）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementRepositoryImplTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Container</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="s">&quot;postgres:15&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withDatabaseName</span><span class="p">(</span><span class="s">&quot;testdb&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withUsername</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withPassword</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@DynamicPropertySource</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureProperties</span><span class="p">(</span><span class="n">DynamicPropertyRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getJdbcUrl</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.username&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getUsername</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getPassword</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatementRepositoryImpl</span><span class="w"> </span><span class="n">repository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JdbcTemplate</span><span class="w"> </span><span class="n">jdbcTemplate</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">setupTestData</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setupTestData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 勘定科目マスタ（P/L科目）</span>
<span class="w">        </span><span class="n">jdbcTemplate</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">            INSERT INTO &quot;勘定科目マスタ&quot; (&quot;勘定科目コード&quot;, &quot;勘定科目名&quot;, &quot;BSPL区分&quot;, &quot;貸借区分&quot;, &quot;表示順&quot;)</span>
<span class="s">            VALUES</span>
<span class="s">                (&#39;4110&#39;, &#39;売上高&#39;, &#39;P&#39;, &#39;貸&#39;, 1),</span>
<span class="s">                (&#39;4210&#39;, &#39;受取利息&#39;, &#39;P&#39;, &#39;貸&#39;, 2),</span>
<span class="s">                (&#39;5110&#39;, &#39;仕入高&#39;, &#39;P&#39;, &#39;借&#39;, 3),</span>
<span class="s">                (&#39;5210&#39;, &#39;給与手当&#39;, &#39;P&#39;, &#39;借&#39;, 4),</span>
<span class="s">                (&#39;6110&#39;, &#39;支払利息&#39;, &#39;P&#39;, &#39;借&#39;, 5)</span>
<span class="s">            ON CONFLICT DO NOTHING</span>
<span class="s">        &quot;&quot;&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 日次勘定科目残高</span>
<span class="w">        </span><span class="n">jdbcTemplate</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">            INSERT INTO &quot;日次勘定科目残高&quot;</span>
<span class="s">                (&quot;起票日&quot;, &quot;勘定科目コード&quot;, &quot;補助科目コード&quot;, &quot;部門コード&quot;,</span>
<span class="s">                 &quot;プロジェクトコード&quot;, &quot;決算仕訳フラグ&quot;, &quot;借方金額&quot;, &quot;貸方金額&quot;)</span>
<span class="s">            VALUES</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;4110&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 0, 10000000),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;5110&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 6000000, 0),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;5210&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 2000000, 0),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;4210&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 0, 100000),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;6110&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 50000, 0)</span>
<span class="s">            ON CONFLICT DO NOTHING</span>
<span class="s">        &quot;&quot;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;期間指定での残高取得&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">FindByPeriod</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;指定期間の P/L 科目残高を取得できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_期間指定の残高取得</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">items</span><span class="p">).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// 売上高の確認</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;4110&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">findFirst</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">sales</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;10000000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">sales</span><span class="p">.</span><span class="na">isRevenue</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">sales</span><span class="p">.</span><span class="na">isSales</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// 仕入高の確認</span>
<span class="w">            </span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">cogs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;5110&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">findFirst</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">cogs</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;6000000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">cogs</span><span class="p">.</span><span class="na">isExpense</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">cogs</span><span class="p">.</span><span class="na">isCostOfSales</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;会計年度指定での残高取得&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">FindByFiscalYear</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;会計年度の残高を取得できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_会計年度の残高取得</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given: 2024年度（2024年4月〜2025年3月）</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2024</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="na">findByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">items</span><span class="p">).</span><span class="na">isNotEmpty</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;収益・費用の検証&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">RevenueExpenseValidation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;収益・費用を正しく分類できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_収益費用の分類</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalRevenues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isRevenue</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalExpenses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">isExpense</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// 収益: 10,000,000 + 100,000 = 10,100,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">totalRevenues</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;10100000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// 費用: 6,000,000 + 2,000,000 + 50,000 = 8,050,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">totalExpenses</span><span class="p">).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;8050000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="207-input-port">20.7 Input Port の定義<a class="headerlink" href="#207-input-port" title="Permanent link">&para;</a></h2>
<h3 id="2071-incomestatementusecase">20.7.1 IncomeStatementUseCase インターフェース<a class="headerlink" href="#2071-incomestatementusecase" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatement</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書ユースケース（Input Port）</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">IncomeStatementUseCase</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定期間の損益計算書を生成</span>
<span class="cm">     *</span>
<span class="cm">     * @param fromDate 開始日</span>
<span class="cm">     * @param toDate   終了日</span>
<span class="cm">     * @return 損益計算書</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByPeriod</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 指定会計年度の損益計算書を生成</span>
<span class="cm">     *</span>
<span class="cm">     * @param fiscalYear 会計年度</span>
<span class="cm">     * @return 損益計算書</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByFiscalYear</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 月次損益計算書を生成</span>
<span class="cm">     *</span>
<span class="cm">     * @param fiscalYear 会計年度</span>
<span class="cm">     * @param month      月（1-12）</span>
<span class="cm">     * @return 損益計算書</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByMonth</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="208-application-service">20.8 Application Service の実装<a class="headerlink" href="#208-application-service" title="Permanent link">&para;</a></h2>
<h3 id="2081-incomestatementservice">20.8.1 IncomeStatementService<a class="headerlink" href="#2081-incomestatementservice" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.IncomeStatementUseCase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.out.IncomeStatementRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書アプリケーションサービス</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Transactional</span><span class="p">(</span><span class="n">readOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementService</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">IncomeStatementUseCase</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">IncomeStatementRepository</span><span class="w"> </span><span class="n">incomeStatementRepository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByPeriod</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>
<span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFiscalYear</span><span class="p">(</span><span class="n">toDate</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByFiscalYear</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">);</span>
<span class="w">        </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="nf">generateByMonth</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByMonth</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 月の開始日・終了日を計算</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fromDate</span><span class="p">.</span><span class="na">withDayOfMonth</span><span class="p">(</span><span class="n">fromDate</span><span class="p">.</span><span class="na">lengthOfMonth</span><span class="p">());</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">IncomeStatement</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">items</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 日付から会計年度を取得（4月始まり）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">getFiscalYear</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">getYear</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">getMonthValue</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="209-application-service">20.9 Application Service のテスト<a class="headerlink" href="#209-application-service" title="Permanent link">&para;</a></h2>
<h3 id="2091-mockito">20.9.1 Mockito を使った単体テスト<a class="headerlink" href="#2091-mockito" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.out.IncomeStatementRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mockito.InjectMocks</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mockito.Mock</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mockito.junit.jupiter.MockitoExtension</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.assertThat</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.mockito.ArgumentMatchers.any</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.mockito.ArgumentMatchers.eq</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.mockito.Mockito.when</span><span class="p">;</span>

<span class="nd">@ExtendWith</span><span class="p">(</span><span class="n">MockitoExtension</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatementService（損益計算書サービス）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementServiceTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Mock</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatementRepository</span><span class="w"> </span><span class="n">incomeStatementRepository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@InjectMocks</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">IncomeStatementService</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sampleItems</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// テストデータ</span>
<span class="w">        </span><span class="n">sampleItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;仕入高&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;6000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;5210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;給与手当&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;2000000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;4210&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;受取利息&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;貸&quot;</span><span class="p">),</span>
<span class="w">                </span><span class="n">IncomeStatementItem</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;6110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;支払利息&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;50000&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;損益計算書生成&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">GenerateIncomeStatement</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;期間指定で損益計算書を生成できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_期間指定での生成</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">);</span>
<span class="w">            </span><span class="n">when</span><span class="p">(</span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">)).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">sampleItems</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">.</span><span class="na">generateByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFromDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">fromDate</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getToDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">toDate</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFiscalYear</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2024</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getRevenues</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getExpenses</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;会計年度指定で損益計算書を生成できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_会計年度指定での生成</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2024</span><span class="p">;</span>
<span class="w">            </span><span class="n">when</span><span class="p">(</span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">)).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">sampleItems</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">.</span><span class="na">generateByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFromDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getToDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFiscalYear</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2024</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;月次損益計算書を生成できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_月次損益計算書の生成</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2024</span><span class="p">;</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">            </span><span class="n">when</span><span class="p">(</span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByMonth</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">sampleItems</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">.</span><span class="na">generateByMonth</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFromDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getToDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getFiscalYear</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2024</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;利益計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ProfitCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;各段階利益が計算される&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_段階利益の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">when</span><span class="p">(</span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">any</span><span class="p">(),</span><span class="w"> </span><span class="n">any</span><span class="p">())).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">sampleItems</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">.</span><span class="na">generateByPeriod</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">));</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="c1">// 売上総利益 = 10,000,000 - 6,000,000 = 4,000,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getGrossProfit</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;4000000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// 営業利益 = 4,000,000 - 2,000,000 = 2,000,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getOperatingIncome</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2000000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// 経常利益 = 2,000,000 + 100,000 - 50,000 = 2,050,000</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getOrdinaryIncome</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2050000&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// 当期純利益 = 2,050,000 (法人税等なし)</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getNetIncome</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;2050000&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;利益率計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ProfitMarginCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;各利益率が計算される&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_利益率の計算</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Given</span>
<span class="w">            </span><span class="n">when</span><span class="p">(</span><span class="n">incomeStatementRepository</span><span class="p">.</span><span class="na">findByPeriod</span><span class="p">(</span><span class="n">any</span><span class="p">(),</span><span class="w"> </span><span class="n">any</span><span class="p">())).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">sampleItems</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// When</span>
<span class="w">            </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementService</span><span class="p">.</span><span class="na">generateByPeriod</span><span class="p">(</span>
<span class="w">                    </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="p">));</span>

<span class="w">            </span><span class="c1">// Then</span>
<span class="w">            </span><span class="c1">// 売上総利益率 = 4,000,000 / 10,000,000 × 100 = 40%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getGrossProfitMargin</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;40.00&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// 営業利益率 = 2,000,000 / 10,000,000 × 100 = 20%</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getOperatingProfitMargin</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="s">&quot;20.00&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="2010-input-adapter">20.10 Input Adapter の実装<a class="headerlink" href="#2010-input-adapter" title="Permanent link">&para;</a></h2>
<h3 id="20101-incomestatementcontroller">20.10.1 IncomeStatementController<a class="headerlink" href="#20101-incomestatementcontroller" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.IncomeStatementUseCase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.dto.IncomeStatementResponse</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.format.annotation.DateTimeFormat</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.http.ResponseEntity</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書コントローラー（Input Adapter）</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/api/income-statements&quot;</span><span class="p">)</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">IncomeStatementUseCase</span><span class="w"> </span><span class="n">incomeStatementUseCase</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 期間指定で損益計算書を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">IncomeStatementResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getIncomeStatement</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementUseCase</span><span class="p">.</span><span class="na">generateByPeriod</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">IncomeStatementResponse</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 会計年度指定で損益計算書を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/fiscal-year/{fiscalYear}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">IncomeStatementResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getIncomeStatementByFiscalYear</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementUseCase</span><span class="p">.</span><span class="na">generateByFiscalYear</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">IncomeStatementResponse</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 月次損益計算書を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/fiscal-year/{fiscalYear}/month/{month}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">IncomeStatementResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getMonthlyIncomeStatement</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incomeStatementUseCase</span><span class="p">.</span><span class="na">generateByMonth</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">IncomeStatementResponse</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">incomeStatement</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="20102-dto">20.10.2 DTO クラス<a class="headerlink" href="#20102-dto" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.dto</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.financial.IncomeStatementItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Value</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 損益計算書レスポンス DTO</span>
<span class="cm"> */</span>
<span class="nd">@Value</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementResponse</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">;</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">;</span>
<span class="w">    </span><span class="n">Integer</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">;</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItemDto</span><span class="o">&gt;</span><span class="w"> </span><span class="n">revenues</span><span class="p">;</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IncomeStatementItemDto</span><span class="o">&gt;</span><span class="w"> </span><span class="n">expenses</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalSales</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalRevenues</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalExpenses</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfit</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingIncome</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">ordinaryIncome</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">incomeBeforeTaxes</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">netIncome</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">grossProfitMargin</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">operatingProfitMargin</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">ordinaryProfitMargin</span><span class="p">;</span>
<span class="w">    </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">netProfitMargin</span><span class="p">;</span>
<span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">profitable</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IncomeStatementResponse</span><span class="w"> </span><span class="nf">from</span><span class="p">(</span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">incomeStatement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncomeStatementResponse</span><span class="p">(</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getFromDate</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getToDate</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getFiscalYear</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getRevenues</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItemDto</span><span class="p">::</span><span class="n">from</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">()),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getExpenses</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">IncomeStatementItemDto</span><span class="p">::</span><span class="n">from</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">()),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getTotalSales</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getTotalRevenues</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getTotalExpenses</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getGrossProfit</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOperatingIncome</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOrdinaryIncome</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getIncomeBeforeTaxes</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getNetIncome</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getGrossProfitMargin</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOperatingProfitMargin</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getOrdinaryProfitMargin</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">getNetProfitMargin</span><span class="p">(),</span>
<span class="w">                </span><span class="n">incomeStatement</span><span class="p">.</span><span class="na">isProfitable</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Value</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IncomeStatementItemDto</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">accountName</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">category</span><span class="p">;</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">percentage</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">IncomeStatementItemDto</span><span class="w"> </span><span class="nf">from</span><span class="p">(</span><span class="n">IncomeStatementItem</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncomeStatementItemDto</span><span class="p">(</span>
<span class="w">                    </span><span class="n">item</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">item</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">item</span><span class="p">.</span><span class="na">getCategory</span><span class="p">().</span><span class="na">getDisplayName</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">item</span><span class="p">.</span><span class="na">getAmount</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">item</span><span class="p">.</span><span class="na">getPercentage</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="2011-input-adapter">20.11 Input Adapter のテスト<a class="headerlink" href="#2011-input-adapter" title="Permanent link">&para;</a></h2>
<h3 id="20111-rest-api">20.11.1 REST API 統合テスト<a class="headerlink" href="#20111-rest-api" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.jdbc.core.JdbcTemplate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertyRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertySource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.containers.PostgreSQLContainer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Container</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Testcontainers</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.hamcrest.Matchers.*</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers.*</span><span class="p">;</span>

<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="nd">@Testcontainers</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;IncomeStatementController（損益計算書API）&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">IncomeStatementControllerTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Container</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="s">&quot;postgres:15&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withDatabaseName</span><span class="p">(</span><span class="s">&quot;testdb&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withUsername</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withPassword</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@DynamicPropertySource</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureProperties</span><span class="p">(</span><span class="n">DynamicPropertyRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getJdbcUrl</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.username&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getUsername</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getPassword</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MockMvc</span><span class="w"> </span><span class="n">mockMvc</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JdbcTemplate</span><span class="w"> </span><span class="n">jdbcTemplate</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">setupTestData</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setupTestData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">jdbcTemplate</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">            INSERT INTO &quot;勘定科目マスタ&quot; (&quot;勘定科目コード&quot;, &quot;勘定科目名&quot;, &quot;BSPL区分&quot;, &quot;貸借区分&quot;, &quot;表示順&quot;)</span>
<span class="s">            VALUES</span>
<span class="s">                (&#39;4110&#39;, &#39;売上高&#39;, &#39;P&#39;, &#39;貸&#39;, 1),</span>
<span class="s">                (&#39;5110&#39;, &#39;仕入高&#39;, &#39;P&#39;, &#39;借&#39;, 2),</span>
<span class="s">                (&#39;5210&#39;, &#39;給与手当&#39;, &#39;P&#39;, &#39;借&#39;, 3)</span>
<span class="s">            ON CONFLICT DO NOTHING</span>
<span class="s">        &quot;&quot;&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">jdbcTemplate</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">            INSERT INTO &quot;日次勘定科目残高&quot;</span>
<span class="s">                (&quot;起票日&quot;, &quot;勘定科目コード&quot;, &quot;補助科目コード&quot;, &quot;部門コード&quot;,</span>
<span class="s">                 &quot;プロジェクトコード&quot;, &quot;決算仕訳フラグ&quot;, &quot;借方金額&quot;, &quot;貸方金額&quot;)</span>
<span class="s">            VALUES</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;4110&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 0, 10000000),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;5110&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 6000000, 0),</span>
<span class="s">                (&#39;2024-06-15&#39;, &#39;5210&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, 0, 2000000, 0)</span>
<span class="s">            ON CONFLICT DO NOTHING</span>
<span class="s">        &quot;&quot;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;GET /api/income-statements&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">GetIncomeStatement</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;期間指定で損益計算書を取得できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_期間指定での取得</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/income-statements&quot;</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;fromDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2024-04-01&quot;</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;toDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2025-03-31&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.fromDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2024-04-01&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.toDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2025-03-31&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.totalSales&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mi">10000000</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.grossProfit&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mi">4000000</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.operatingIncome&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mi">2000000</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.profitable&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;利益率が計算されている&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_利益率の計算</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/income-statements&quot;</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;fromDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2024-04-01&quot;</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;toDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2025-03-31&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.grossProfitMargin&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mf">40.00</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.operatingProfitMargin&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mf">20.00</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;GET /api/income-statements/fiscal-year/{fiscalYear}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">GetIncomeStatementByFiscalYear</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;会計年度指定で損益計算書を取得できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_会計年度指定での取得</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/income-statements/fiscal-year/2024&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.fiscalYear&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mi">2024</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.fromDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2024-04-01&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.toDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2025-03-31&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;GET /api/income-statements/fiscal-year/{fiscalYear}/month/{month}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">GetMonthlyIncomeStatement</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;月次損益計算書を取得できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_月次損益計算書の取得</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/income-statements/fiscal-year/2024/month/6&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.fiscalYear&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="mi">2024</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.fromDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2024-06-01&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">jsonPath</span><span class="p">(</span><span class="s">&quot;$.toDate&quot;</span><span class="p">).</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;2024-06-30&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="2012">20.12 本章のまとめ<a class="headerlink" href="#2012" title="Permanent link">&para;</a></h2>
<p>本章では、損益計算書機能をヘキサゴナルアーキテクチャに従い TDD で実装しました。</p>
<h3 id="_5">実装したコンポーネント<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>レイヤー</th>
<th>コンポーネント</th>
<th>責務</th>
</tr>
</thead>
<tbody>
<tr>
<td>Domain Model</td>
<td>IncomeStatementCategory</td>
<td>損益計算書区分（売上高、売上原価、販管費など）</td>
</tr>
<tr>
<td>Domain Model</td>
<td>IncomeStatementItem</td>
<td>損益計算書項目（金額計算、対売上高比率）</td>
</tr>
<tr>
<td>Domain Model</td>
<td>IncomeStatement</td>
<td>損益計算書（段階利益計算、利益率計算）</td>
</tr>
<tr>
<td>Input Port</td>
<td>IncomeStatementUseCase</td>
<td>ユースケース定義</td>
</tr>
<tr>
<td>Output Port</td>
<td>IncomeStatementRepository</td>
<td>リポジトリインターフェース</td>
</tr>
<tr>
<td>Application</td>
<td>IncomeStatementService</td>
<td>アプリケーションサービス</td>
</tr>
<tr>
<td>Output Adapter</td>
<td>IncomeStatementRepositoryImpl</td>
<td>MyBatis 実装</td>
</tr>
<tr>
<td>Input Adapter</td>
<td>IncomeStatementController</td>
<td>REST API</td>
</tr>
</tbody>
</table>
<h3 id="_6">設計のポイント<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjYzOXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6ODE1cHg7aGVpZ2h0OjYzOXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDgxNSA2MzkiIHdpZHRoPSI4MTVweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjU2MTM7JiMzMDQxMDsmIzM1MzM2OyYjMzE2Mzk7JiMyNjM2MDsmIzEyMzk4OyYjMzUzNzM7JiMzNTMzNjsmIzEyNTA5OyYjMTI0NTI7JiMxMjUzMTsmIzEyNDg4OzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2Ny45OTkzIiB4PSIzMTYuNTAwNCIgeT0iMjIuOTk1MSI+JiMyNTYxMzsmIzMwNDEwOyYjMzUzMzY7JiMzMTYzOTsmIzI2MzYwOyYjMTIzOTg7JiMzNTM3MzsmIzM1MzM2OyYjMTI1MDk7JiMxMjQ1MjsmIzEyNTMxOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBwcm9maXQtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0icHJvZml0IiBkYXRhLXNvdXJjZS1saW5lPSIzIiBpZD0iZW50MDAwMiI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIzOTIuMTkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNTciIHg9IjciIHk9IjExOC44NDY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjciIHgyPSIxNjQiIHkxPSIxMzkuMTQzNyIgeTI9IjEzOS4xNDM3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjU3LjUwMDEiIHk9IjEzMy44NDIiPiYjMjc1NzM7JiMzODU0MjsmIzIxMDMzOyYjMzA0MTA7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBtYXJnaW4tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0ibWFyZ2luIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgaWQ9ImVudDAwMDciPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMTk5LjU5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjk2IiB4PSIyMDQiIHk9IjExOC44NDY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIwNCIgeDI9IjUwMCIgeTE9IjEzOS4xNDM3IiB5Mj0iMTM5LjE0MzciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMzMxLjAwMDEiIHk9IjEzMy44NDIiPiYjMjEwMzM7JiMzMDQxMDsmIzI5NTc1OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgcmF0aW8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0icmF0aW8iIGRhdGEtc291cmNlLWxpbmU9IjE3IiBpZD0iZW50MDAxMiI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIxMDMuMyIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI2OCIgeD0iNTQwIiB5PSIxMTguODQ2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI1NDAiIHgyPSI4MDgiIHkxPSIxMzkuMTQzNyIgeTI9IjEzOS4xNDM3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjYzMi4wMDAyIiB5PSIxMzMuODQyIj4mIzIzNTUwOyYjMjI3NzA7JiMxOTk3ODsmIzM5NjQwOyYjMjc2MDQ7JiMyOTU3NTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgZ3Jvc3MtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJwcm9maXQuZ3Jvc3MiIGRhdGEtc291cmNlLWxpbmU9IjQiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijg5Ljk5OTciIHg9IjMxIiB5PSIxNjEuODQ2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQxIiB5PSIxODQuODQyIj4mIzIyNzcwOyYjMTk5Nzg7JiMzMjIwNzsmIzIxMDMzOyYjMzA0MTA7PC90ZXh0PjwvZz48IS0tZW50aXR5IG9wZXJhdGluZy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InByb2ZpdC5vcGVyYXRpbmciIGRhdGEtc291cmNlLWxpbmU9IjUiIGlkPSJlbnQwMDA0Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijc1Ljk5OTgiIHg9IjM4IiB5PSIyNTguMTQ2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjQ4IiB5PSIyODEuMTQyIj4mIzIxOTQyOyYjMjY5ODk7JiMyMTAzMzsmIzMwNDEwOzwvdGV4dD48L2c+PCEtLWVudGl0eSBvcmRpbmFyeS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InByb2ZpdC5vcmRpbmFyeSIgZGF0YS1zb3VyY2UtbGluZT0iNiIgaWQ9ImVudDAwMDUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNzUuOTk5OCIgeD0iMzgiIHk9IjM1NC40MzY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNDgiIHk9IjM3Ny40MzIiPiYjMzIwNzY7JiMyNDEyMDsmIzIxMDMzOyYjMzA0MTA7PC90ZXh0PjwvZz48IS0tZW50aXR5IG5ldC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InByb2ZpdC5uZXQiIGRhdGEtc291cmNlLWxpbmU9IjciIGlkPSJlbnQwMDA2Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijg5Ljk5OTciIHg9IjMxIiB5PSI0NTAuNzM2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQxIiB5PSI0NzMuNzMyIj4mIzI0NDAzOyYjMjYzOTk7JiMzMjAyMDsmIzIxMDMzOyYjMzA0MTA7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Im1hcmdpbi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjExIiBpZD0iZW50MDAwOCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMDMuOTk5NiIgeD0iMjI4IiB5PSIxNjEuODQ2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjIzOCIgeT0iMTg0Ljg0MiI+JiMyMjc3MDsmIzE5OTc4OyYjMzIyMDc7JiMyMTAzMzsmIzMwNDEwOyYjMjk1NzU7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0ibWFyZ2luLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgaWQ9ImVudDAwMDkiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODkuOTk5NyIgeD0iMzY3IiB5PSIxNjEuODQ2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjM3NyIgeT0iMTg0Ljg0MiI+JiMyMTk0MjsmIzI2OTg5OyYjMjEwMzM7JiMzMDQxMDsmIzI5NTc1OzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Im1hcmdpbi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTMiIGlkPSJlbnQwMDEwIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijg5Ljk5OTciIHg9IjIyOCIgeT0iMjU4LjE0NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIyMzgiIHk9IjI4MS4xNDIiPiYjMzIwNzY7JiMyNDEyMDsmIzIxMDMzOyYjMzA0MTA7JiMyOTU3NTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0ibWFyZ2luLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTQiIGlkPSJlbnQwMDExIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMy45OTk2IiB4PSIzNTMiIHk9IjI1OC4xNDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMzYzIiB5PSIyODEuMTQyIj4mIzI0NDAzOyYjMjYzOTk7JiMzMjAyMDsmIzIxMDMzOyYjMzA0MTA7JiMyOTU3NTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJyYXRpby4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGlkPSJlbnQwMDEzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijg5Ljk5OTciIHg9IjU2NCIgeT0iMTYxLjg0NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSI1NzQiIHk9IjE4NC44NDIiPiYjMjI3NzA7JiMxOTk3ODsmIzIxNDA3OyYjMjAzODU7JiMyOTU3NTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InJhdGlvLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjE5IiBpZD0iZW50MDAxNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3NS45OTk4IiB4PSI2ODkiIHk9IjE2MS44NDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNjk5IiB5PSIxODQuODQyIj4mIzM2MDA5OyYjMzE2NDk7JiMzNjAyNzsmIzI5NTc1OzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iR01OMjAiIGRhdGEtc291cmNlLWxpbmU9IjMwIiBpZD0iZW50MDAyMSI+PHBhdGggZD0iTTEzLjUsNTQ3LjAzNjkgTDEzLjUsNjMyLjcwMDkgQTAsMCAwIDAgMCAxMy41LDYzMi43MDA5IEwxMzguNTAwMSw2MzIuNzAwOSBBMCwwIDAgMCAwIDEzOC41MDAxLDYzMi43MDA5IEwxMzguNTAwMSw1NTcuMDM2OSBMMTI4LjUwMDEsNTQ3LjAzNjkgTDgwLDU0Ny4wMzY5IEw3Niw0ODcuNDM2OSBMNzIsNTQ3LjAzNjkgTDEzLjUsNTQ3LjAzNjkgQTAsMCAwIDAgMCAxMy41LDU0Ny4wMzY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTI4LjUwMDEsNTQ3LjAzNjkgTDEyOC41MDAxLDU1Ny4wMzY5IEwxMzguNTAwMSw1NTcuMDM2OSBMMTI4LjUwMDEsNTQ3LjAzNjkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuMDAwMSIgeD0iMTkuNSIgeT0iNTY0LjEwMzgiPiYjMzIwNzY7JiMyMTk0MjsmIzIwOTk4OyYjMjY1MTI7JiMxMjQwODsmIzEyMzk4OyYjMjc5NjM7JiMyOTk5Mjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNC4xMzIzIiB4PSIxOS41IiB5PSI1NzkuMjM2NiI+JiMxNjA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjAwMDEiIHg9IjE5LjUiIHk9IjU5NC4zNjk0Ij4mIzEyNTM5OyYjMjE0NTQ7JiMzMDQxMDsmIzI0NjE1OyYjMjA5OTg7JiMyNjUxMjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTEuMDAwMSIgeD0iMTkuNSIgeT0iNjA5LjUwMjIiPiYjMTI1Mzk7JiMzNjAyNzsmIzI5OTkyOyYjMjcwODM7JiMzNjg5NjsmIzIwOTk4OyYjMjY1MTI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkxLjAwMDEiIHg9IjE5LjUiIHk9IjYyNC42MzUiPiYjMTI1Mzk7JiMyNjM5OTsmIzM4MjkxOyYjMjc2MDQ7JiMzNjYxMTsmIzIwOTk4OyYjMjY1MTI7PC90ZXh0PjwvZz48IS0tbGluayBncm9zcyB0byBvcGVyYXRpbmctLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMyIgZGF0YS1lbnRpdHktMj0iZW50MDAwNCIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjIyIiBpZD0ibG5rMTUiPjxwYXRoIGQ9Ik03NiwxOTguMjg2OSBDNzYsMjE1LjE5NjkgNzYsMjM0LjgwNjkgNzYsMjUxLjc4NjkiIGZpbGw9Im5vbmUiIGlkPSJncm9zcy10by1vcGVyYXRpbmciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijc2LDI1Ny43ODY5LDgwLDI0OC43ODY5LDc2LDI1Mi43ODY5LDcyLDI0OC43ODY5LDc2LDI1Ny43ODY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIG9wZXJhdGluZyB0byBvcmRpbmFyeS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA0IiBkYXRhLWVudGl0eS0yPSJlbnQwMDA1IiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iMjMiIGlkPSJsbmsxNiI+PHBhdGggZD0iTTc2LDI5NC41ODY5IEM3NiwzMTEuNDk2OSA3NiwzMzEuMTA2OSA3NiwzNDguMDg2OSIgZmlsbD0ibm9uZSIgaWQ9Im9wZXJhdGluZy10by1vcmRpbmFyeSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzYsMzU0LjA4NjksODAsMzQ1LjA4NjksNzYsMzQ5LjA4NjksNzIsMzQ1LjA4NjksNzYsMzU0LjA4NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgb3JkaW5hcnkgdG8gbmV0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDUiIGRhdGEtZW50aXR5LTI9ImVudDAwMDYiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIyNCIgaWQ9ImxuazE3Ij48cGF0aCBkPSJNNzYsMzkwLjg4NjkgQzc2LDQwNy43ODY5IDc2LDQyNy4zOTY5IDc2LDQ0NC4zNzY5IiBmaWxsPSJub25lIiBpZD0ib3JkaW5hcnktdG8tbmV0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI3Niw0NTAuMzc2OSw4MCw0NDEuMzc2OSw3Niw0NDUuMzc2OSw3Miw0NDEuMzc2OSw3Niw0NTAuMzc2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBwcm9maXQgdG8gbWFyZ2luLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMDciIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIyNiIgaWQ9ImxuazE4Ij48cGF0aCBkPSJNMTY0LjA2NDIsMTU3LjI5ODIgQzE2NC4xMjM4LDE1Ny4xNTIzIDE2NC4xODM3LDE1Ny4wMDU5IDE2NC4yNDQsMTU2Ljg1OTEgQzE2NS4yMDg3LDE1NC41MDkyIDE2Ni4yNjA1LDE1Mi4wMzgxIDE2Ny40MDA5LDE0OS40NzM4IEMxNjkuNjgxNiwxNDQuMzQ1MyAxNzIuMzE2NiwxMzguODQ0NCAxNzUuMzE2MywxMzMuMTk2OSBDMTg3LjMxNSwxMTAuNjA2OSAyMDUuMTUsODUuNjcxOSAyMjkuNSw3Mi44NDY5IEMyNzMuOTQsNDkuNDM2OSA0MTEuOTUsNDcuODI2OSA0NTUuNSw3Mi44NDY5IEM0NjUuODk1LDc4LjgxNjkgNDczLjQwODgsODguMDI1NiA0NzguODI0MSw5OC41OTA2IEM0ODEuNTMxNywxMDMuODczMSA0ODMuNzE0OCwxMDkuNDk0NyA0ODUuNDcxMSwxMTUuMjIgQzQ4NS42OTA2LDExNS45MzU3IDQ4NS45MDM1LDExNi42NTI5IDQ4Ni4xMDk4LDExNy4zNzE0IEM0ODYuMjEzLDExNy43MzA2IDQ4NC43MDgsMTEyLjMwOTIgNDg0LjgwOCwxMTIuNjY5IiBmaWxsPSJub25lIiBpZD0icHJvZml0LXRvLW1hcmdpbiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDg2LjQxNDYsMTE4LjQ0OTksNDg3Ljg1ODYsMTA4LjcwNzUsNDg1LjA3NTcsMTEzLjYzMjUsNDgwLjE1MDcsMTEwLjg0OTYsNDg2LjQxNDYsMTE4LjQ0OTkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcHJvZml0IHRvIHJhdGlvLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMTIiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIyNyIgaWQ9ImxuazE5Ij48cGF0aCBkPSJNMTY0LjA2NDIsMTU3LjI5ODIgQzE2NC4xMjM4LDE1Ny4xNTIzIDE2NC4xODM3LDE1Ny4wMDU5IDE2NC4yNDQsMTU2Ljg1OTEgQzE2NS4yMDg3LDE1NC41MDkyIDE2Ni4yNjA1LDE1Mi4wMzgxIDE2Ny40MDA5LDE0OS40NzM4IEMxNjkuNjgxNiwxNDQuMzQ1MyAxNzIuMzE2NiwxMzguODQ0NCAxNzUuMzE2MywxMzMuMTk2OSBDMTg3LjMxNSwxMTAuNjA2OSAyMDUuMTUsODUuNjcxOSAyMjkuNSw3Mi44NDY5IEMyODIsNDUuMTk2OSA3MTIuMDUsNDMuMjk2OSA3NjMuNSw3Mi44NDY5IEM3NzMuODk1LDc4LjgxNjkgNzgxLjQwODcsODguMDI1NiA3ODYuODI0MSw5OC41OTA2IEM3ODkuNTMxNywxMDMuODczMSA3OTEuNzE0OCwxMDkuNDk0NyA3OTMuNDcxMSwxMTUuMjIgQzc5My42OTA2LDExNS45MzU3IDc5My45MDM1LDExNi42NTI5IDc5NC4xMDk4LDExNy4zNzE0IEM3OTQuMjEzLDExNy43MzA2IDc5Mi43MDgsMTEyLjMwOTIgNzkyLjgwOCwxMTIuNjY5IiBmaWxsPSJub25lIiBpZD0icHJvZml0LXRvLXJhdGlvIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI3OTQuNDE0NiwxMTguNDQ5OSw3OTUuODU4NiwxMDguNzA3NSw3OTMuMDc1NywxMTMuNjMyNSw3ODguMTUwNywxMTAuODQ5Niw3OTQuNDE0NiwxMTguNDQ5OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48P3BsYW50dW1sLXNyYyBWUDlfSXk5MDdDUl9sclRuLUVWMGp6MXhNTXdrR1R4OVVIMEhXSlFlT0pLNVhxTE05WExFZVdjY0RoMXlDdER0c3hqZUZ2bkVoVnd4RlN6cHQtLXBwcVBMVVlYM3JocGNkUmZsd1RvLU9IdDdoVGMtekh1LWtqZzNVX1JZUVgta2ZXREc0OGE0U3lvVTE3VTZmbV8yNnBhZUxjMlB1QTlBdUdhV1NlNkFJMGRkdlJwZHFTQWZ5eXo2OWdTR05BYmlYRGZKemxnVUlVMm9KNElnOFlNUnVmQ2hwdDZvQUlBZkkySjc2d0UtTS1vLW95VGM5ZVRhMmF4SnJlZEVaT2xPQWViNEtUNl9iUUZlTnNNdGxNcDVkTmtScE05eHRNZXVKek82UnhUaVFBUnI4V1p1anRRVXFMdENVemloX0Q2MHNwcl9ENGs3bndIWE5pOTdBQi1OZVJld2hSc0tQTmZPRUg0emlGb3FVUThnMXBHSzRzdXhTam1OMDhJZjNGU25mUlc0U0o2VTgwV0hjX1JLcXlfUE96RWpIUnlNNnktdVFHYTIwQXVzeW5mNkk4TEwtcWFZYWc4TkNJdE1sbW9nSnNpclgxWXFNbzRhX3FqUmdaQUlPQkpwMW0wMD8+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_7">テストケース一覧<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>テストケース</th>
<th>検証内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>test_収益科目の判定</td>
<td>勘定科目コードから収益区分を判定</td>
</tr>
<tr>
<td>2</td>
<td>test_費用科目の判定</td>
<td>勘定科目コードから費用区分を判定</td>
</tr>
<tr>
<td>3</td>
<td>test_不正な勘定科目コード</td>
<td>例外処理の検証</td>
</tr>
<tr>
<td>4</td>
<td>test_費用区分の判定</td>
<td>売上原価・販管費の判定</td>
</tr>
<tr>
<td>5</td>
<td>test_営業外項目の判定</td>
<td>営業外収益・費用の判定</td>
</tr>
<tr>
<td>6</td>
<td>test_特別項目の判定</td>
<td>特別利益・損失の判定</td>
</tr>
<tr>
<td>7</td>
<td>test_収益科目の金額計算</td>
<td>収益科目の金額計算</td>
</tr>
<tr>
<td>8</td>
<td>test_費用科目の金額計算</td>
<td>費用科目の金額計算</td>
</tr>
<tr>
<td>9</td>
<td>test_販管費の金額計算</td>
<td>販管費の金額計算</td>
</tr>
<tr>
<td>10</td>
<td>test_対売上高比率の計算</td>
<td>対売上高比率計算</td>
</tr>
<tr>
<td>11</td>
<td>test_売上高ゼロの場合</td>
<td>ゼロ除算の回避</td>
</tr>
<tr>
<td>12</td>
<td>test_営業外項目の判定</td>
<td>営業外収益・費用判定</td>
</tr>
<tr>
<td>13</td>
<td>test_特別項目の判定</td>
<td>特別利益・損失判定</td>
</tr>
<tr>
<td>14</td>
<td>test_損益計算書の作成</td>
<td>P/L の基本構造</td>
</tr>
<tr>
<td>15</td>
<td>test_売上総利益の計算</td>
<td>売上高 - 売上原価</td>
</tr>
<tr>
<td>16</td>
<td>test_営業利益の計算</td>
<td>売上総利益 - 販管費</td>
</tr>
<tr>
<td>17</td>
<td>test_経常利益の計算</td>
<td>営業利益 ± 営業外損益</td>
</tr>
<tr>
<td>18</td>
<td>test_税引前当期純利益の計算</td>
<td>経常利益 ± 特別損益</td>
</tr>
<tr>
<td>19</td>
<td>test_当期純利益の計算</td>
<td>税引前 - 法人税等</td>
</tr>
<tr>
<td>20</td>
<td>test_売上総利益率の計算</td>
<td>売上総利益 / 売上高 × 100</td>
</tr>
<tr>
<td>21</td>
<td>test_営業利益率の計算</td>
<td>営業利益 / 売上高 × 100</td>
</tr>
<tr>
<td>22</td>
<td>test_売上原価率の計算</td>
<td>売上原価 / 売上高 × 100</td>
</tr>
<tr>
<td>23</td>
<td>test_販管費比率の計算</td>
<td>販管費 / 売上高 × 100</td>
</tr>
<tr>
<td>24</td>
<td>test_黒字判定</td>
<td>当期純利益 &gt; 0</td>
</tr>
<tr>
<td>25</td>
<td>test_赤字判定</td>
<td>当期純利益 &lt; 0</td>
</tr>
<tr>
<td>26</td>
<td>test_期間指定の残高取得</td>
<td>リポジトリ統合テスト</td>
</tr>
<tr>
<td>27</td>
<td>test_会計年度の残高取得</td>
<td>リポジトリ統合テスト</td>
</tr>
<tr>
<td>28</td>
<td>test_収益費用の分類</td>
<td>収益・費用の正しい分類</td>
</tr>
<tr>
<td>29</td>
<td>test_期間指定での生成</td>
<td>サービステスト</td>
</tr>
<tr>
<td>30</td>
<td>test_会計年度指定での生成</td>
<td>サービステスト</td>
</tr>
<tr>
<td>31</td>
<td>test_月次損益計算書の生成</td>
<td>サービステスト</td>
</tr>
<tr>
<td>32</td>
<td>test_段階利益の計算</td>
<td>サービステスト</td>
</tr>
<tr>
<td>33</td>
<td>test_利益率の計算</td>
<td>サービステスト</td>
</tr>
<tr>
<td>34</td>
<td>test_期間指定での取得</td>
<td>API 統合テスト</td>
</tr>
<tr>
<td>35</td>
<td>test_利益率の計算</td>
<td>API 統合テスト</td>
</tr>
<tr>
<td>36</td>
<td>test_会計年度指定での取得</td>
<td>API 統合テスト</td>
</tr>
<tr>
<td>37</td>
<td>test_月次損益計算書の取得</td>
<td>API 統合テスト</td>
</tr>
</tbody>
</table>
<hr />
<p>次章では、財務分析機能を実装します。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/case-study-accounting" target="_blank" rel="noopener" title="財務会計システム ケーススタディ" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../assets/js/extra.js"></script>
      
    
  </body>
</html>