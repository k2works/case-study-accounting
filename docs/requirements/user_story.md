# ユーザーストーリー - 財務会計システム

## 概要

本ドキュメントは、財務会計システムのユーザーストーリーを定義します。
各ストーリーはビジネスユースケース（BUC）およびシステムユースケース（UC）からトレーサブルです。

## トレーサビリティマトリクス

| ストーリーID | ユースケース | BUC | カテゴリ | 優先度 |
|-------------|-------------|-----|---------|--------|
| US-AUTH-001 | UC-AUTH-001 | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-AUTH-002 | UC-AUTH-002 | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-AUTH-003 | UC-AUTH-003 | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-AUTH-004 | - | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-AUTH-005 | - | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-AUTH-006 | - | BUC-006 | 認証・ユーザー管理 | 必須 |
| US-MST-001 | UC-MST-001 | BUC-005 | マスタ管理 | 必須 |
| US-MST-002 | UC-MST-002 | BUC-005 | マスタ管理 | 必須 |
| US-MST-003 | UC-MST-003 | BUC-005 | マスタ管理 | 必須 |
| US-MST-004 | UC-MST-004 | BUC-005 | マスタ管理 | 必須 |
| US-MST-005 | - | BUC-005 | マスタ管理 | 重要 |
| US-MST-006 | - | BUC-005 | マスタ管理 | 重要 |
| US-MST-007 | - | BUC-005 | マスタ管理 | 重要 |
| US-MST-008 | - | BUC-005 | マスタ管理 | 重要 |
| US-JNL-001 | UC-JNL-001 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-002 | UC-JNL-002 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-003 | UC-JNL-003 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-004 | UC-JNL-004 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-005 | UC-JNL-005 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-006 | UC-JNL-006 | BUC-001 | 仕訳管理 | 重要 |
| US-JNL-007 | UC-JNL-007 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-008 | UC-JNL-008 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-009 | UC-JNL-009 | BUC-001 | 仕訳管理 | 必須 |
| US-JNL-010 | UC-JNL-010 | BUC-001 | 仕訳管理 | 必須 |
| US-LDG-001 | UC-LDG-001 | BUC-001 | 元帳・残高管理 | 必須 |
| US-LDG-002 | UC-LDG-002 | BUC-001 | 元帳・残高管理 | 重要 |
| US-LDG-003 | UC-LDG-003 | BUC-001 | 元帳・残高管理 | 必須 |
| US-LDG-004 | UC-LDG-004 | BUC-002 | 元帳・残高管理 | 必須 |
| US-LDG-005 | UC-LDG-005 | BUC-002 | 元帳・残高管理 | 必須 |
| US-FS-001 | UC-FS-001 | BUC-002, BUC-003 | 財務諸表 | 必須 |
| US-FS-002 | UC-FS-002 | BUC-002, BUC-003 | 財務諸表 | 必須 |
| US-FS-003 | UC-FS-003 | BUC-004 | 財務諸表 | 重要 |
| US-SYS-001 | UC-SYS-001 | BUC-006 | システム管理 | 必須 |
| US-SYS-002 | UC-SYS-002 | BUC-006 | システム管理 | 重要 |

---

## 認証・ユーザー管理

### US-AUTH-001: ログイン

**として**: システム利用者
**したい**: ユーザーIDとパスワードでシステムにログインしたい
**なぜなら**: 自分の権限に応じた機能を利用するため

**関連**: UC-AUTH-001, BUC-006

**受入条件**:

- [ ] ユーザーIDとパスワードを入力してログインできる
- [ ] 認証成功時、JWT トークンが発行される
- [ ] 認証失敗時、エラーメッセージが表示される
- [ ] 3回連続でログイン失敗した場合、アカウントがロックされる
- [ ] ログイン成功後、ダッシュボード画面に遷移する

---

### US-AUTH-002: ログアウト

**として**: ログイン済みユーザー
**したい**: システムからログアウトしたい
**なぜなら**: セキュリティを確保し、他者の不正利用を防ぐため

**関連**: UC-AUTH-002, BUC-006

**受入条件**:

- [ ] ログアウトボタンをクリックするとログアウトできる
- [ ] ログアウト後、ログイン画面に遷移する
- [ ] JWT トークンが無効化される

---

### US-AUTH-003: ユーザー登録

**として**: システム管理者
**したい**: 新しいユーザーを登録したい
**なぜなら**: 新入社員や新しい担当者がシステムを利用できるようにするため

**関連**: UC-AUTH-003, BUC-006

**受入条件**:

- [ ] ユーザーID、氏名、パスワード、ロールを入力して登録できる
- [ ] ユーザーIDは一意である必要がある
- [ ] パスワードは8文字以上で、英数字を含む必要がある
- [ ] ロールは管理者、経理責任者、経理担当者、閲覧者から選択できる
- [ ] 登録成功時、確認メッセージが表示される

---

### US-AUTH-004: ユーザー編集

**として**: システム管理者
**したい**: 既存ユーザーの情報を編集したい
**なぜなら**: 人事異動や権限変更に対応するため

**関連**: BUC-006

**受入条件**:

- [ ] 氏名、パスワード、ロールを編集できる
- [ ] ユーザーIDは変更できない
- [ ] 編集成功時、確認メッセージが表示される

---

### US-AUTH-005: ユーザー削除

**として**: システム管理者
**したい**: 不要になったユーザーを削除したい
**なぜなら**: 退職者等のアカウントを無効化するため

**関連**: BUC-006

**受入条件**:

- [ ] 削除前に確認ダイアログが表示される
- [ ] 削除後、ユーザー一覧から該当ユーザーが消える
- [ ] 削除されたユーザーはログインできなくなる
- [ ] 関連する監査ログは保持される

---

### US-AUTH-006: ユーザー一覧表示

**として**: システム管理者
**したい**: 登録済みユーザーの一覧を表示したい
**なぜなら**: ユーザーの管理状況を把握するため

**関連**: BUC-006

**受入条件**:

- [ ] ユーザーID、氏名、ロール、最終ログイン日時が一覧表示される
- [ ] ロールでフィルタリングできる
- [ ] ユーザーIDまたは氏名で検索できる
- [ ] 一覧から詳細画面に遷移できる

---

## マスタ管理

### US-MST-001: 勘定科目登録

**として**: 経理責任者
**したい**: 新しい勘定科目を登録したい
**なぜなら**: 新しい取引に対応する科目を追加するため

**関連**: UC-MST-001, BUC-005

**受入条件**:

- [ ] 科目コード、科目名、勘定科目種別を入力して登録できる
- [ ] 科目コードは一意である必要がある
- [ ] 勘定科目種別は資産、負債、純資産、収益、費用から選択できる
- [ ] 登録成功時、確認メッセージが表示される

---

### US-MST-002: 勘定科目編集

**として**: 経理責任者
**したい**: 既存の勘定科目を編集したい
**なぜなら**: 科目名の変更や種別の修正に対応するため

**関連**: UC-MST-002, BUC-005

**受入条件**:

- [ ] 科目名、勘定科目種別を編集できる
- [ ] 科目コードは変更できない
- [ ] 仕訳で使用されている科目の種別は変更できない
- [ ] 編集成功時、確認メッセージが表示される

---

### US-MST-003: 勘定科目削除

**として**: 経理責任者
**したい**: 不要な勘定科目を削除したい
**なぜなら**: 使用しなくなった科目を整理するため

**関連**: UC-MST-003, BUC-005

**受入条件**:

- [ ] 削除前に確認ダイアログが表示される
- [ ] 仕訳で使用されている科目は削除できない
- [ ] 削除成功時、確認メッセージが表示される

---

### US-MST-004: 勘定科目一覧表示

**として**: 経理担当者
**したい**: 勘定科目の一覧を表示したい
**なぜなら**: 仕訳入力時に適切な科目を選択するため

**関連**: UC-MST-004, BUC-005

**受入条件**:

- [ ] 科目コード、科目名、勘定科目種別が一覧表示される
- [ ] 勘定科目種別でフィルタリングできる
- [ ] 科目コードまたは科目名で検索できる
- [ ] 階層構造がある場合、ツリー形式で表示できる

---

### US-MST-005: 勘定科目構成登録

**として**: 経理責任者
**したい**: 勘定科目の親子関係を登録したい
**なぜなら**: 科目を体系的に管理し、集計を容易にするため

**関連**: BUC-005

**受入条件**:

- [ ] 親科目と子科目を選択して登録できる
- [ ] 循環参照が発生しないようバリデーションされる
- [ ] 表示順を設定できる
- [ ] 登録成功時、確認メッセージが表示される

---

### US-MST-006: 勘定科目構成編集

**として**: 経理責任者
**したい**: 勘定科目の親子関係を編集したい
**なぜなら**: 科目体系の変更に対応するため

**関連**: BUC-005

**受入条件**:

- [ ] 親科目、子科目、表示順を編集できる
- [ ] 循環参照が発生しないようバリデーションされる
- [ ] 編集成功時、確認メッセージが表示される

---

### US-MST-007: 自動仕訳設定登録

**として**: 経理責任者
**したい**: 定型取引の自動仕訳設定を登録したい
**なぜなら**: 繰り返し発生する仕訳の入力を効率化するため

**関連**: BUC-005

**受入条件**:

- [ ] 設定名、借方科目、貸方科目、デフォルト金額、摘要を入力して登録できる
- [ ] 登録成功時、確認メッセージが表示される

---

### US-MST-008: 自動仕訳設定編集

**として**: 経理責任者
**したい**: 自動仕訳設定を編集したい
**なぜなら**: 取引内容の変更に対応するため

**関連**: BUC-005

**受入条件**:

- [ ] 設定名、借方科目、貸方科目、デフォルト金額、摘要を編集できる
- [ ] 編集成功時、確認メッセージが表示される

---

## 仕訳管理

### US-JNL-001: 仕訳入力

**として**: 経理担当者
**したい**: 取引の仕訳を入力したい
**なぜなら**: 日々の取引を正確に記録するため

**関連**: UC-JNL-001, BUC-001

**受入条件**:

- [ ] 仕訳日付、摘要を入力できる
- [ ] 借方科目、借方金額、貸方科目、貸方金額を入力できる
- [ ] 複数の明細行を追加できる
- [ ] 貸借の合計金額が一致しないと保存できない
- [ ] 存在しない勘定科目は選択できない
- [ ] 保存成功時、確認メッセージが表示される
- [ ] 保存された仕訳のステータスは「下書き」になる

---

### US-JNL-002: 仕訳編集

**として**: 経理担当者
**したい**: 入力済みの仕訳を編集したい
**なぜなら**: 入力ミスを修正するため

**関連**: UC-JNL-002, BUC-001

**受入条件**:

- [ ] 「下書き」ステータスの仕訳のみ編集できる
- [ ] 仕訳日付、摘要、明細行を編集できる
- [ ] 貸借の合計金額が一致しないと保存できない
- [ ] 編集成功時、確認メッセージが表示される

---

### US-JNL-003: 仕訳削除

**として**: 経理担当者
**したい**: 不要な仕訳を削除したい
**なぜなら**: 誤って入力した仕訳を取り消すため

**関連**: UC-JNL-003, BUC-001

**受入条件**:

- [ ] 「下書き」ステータスの仕訳のみ削除できる
- [ ] 削除前に確認ダイアログが表示される
- [ ] 削除成功時、確認メッセージが表示される

---

### US-JNL-004: 仕訳一覧表示

**として**: 経理担当者
**したい**: 仕訳の一覧を表示したい
**なぜなら**: 入力済みの仕訳を確認するため

**関連**: UC-JNL-004, BUC-001

**受入条件**:

- [ ] 仕訳番号、仕訳日付、摘要、金額、ステータスが一覧表示される
- [ ] ステータスでフィルタリングできる
- [ ] 日付範囲で絞り込みできる
- [ ] 一覧から詳細画面に遷移できる

---

### US-JNL-005: 仕訳検索

**として**: 経理担当者
**したい**: 条件を指定して仕訳を検索したい
**なぜなら**: 特定の取引を素早く見つけるため

**関連**: UC-JNL-005, BUC-001

**受入条件**:

- [ ] 仕訳日付、勘定科目、金額範囲、摘要で検索できる
- [ ] 複数条件を組み合わせて検索できる
- [ ] 検索結果が一覧表示される

---

### US-JNL-006: 自動仕訳生成

**として**: 経理担当者
**したい**: 定型取引の仕訳を自動生成したい
**なぜなら**: 入力作業を効率化するため

**関連**: UC-JNL-006, BUC-001

**受入条件**:

- [ ] 自動仕訳設定を選択して仕訳を生成できる
- [ ] 生成された仕訳は編集可能
- [ ] 金額は手動で変更できる
- [ ] 生成成功時、確認メッセージが表示される

---

### US-JNL-007: 仕訳承認申請

**として**: 経理担当者
**したい**: 入力した仕訳の承認を申請したい
**なぜなら**: 上長の承認を得て仕訳を確定するため

**関連**: UC-JNL-007, BUC-001

**受入条件**:

- [ ] 「下書き」ステータスの仕訳のみ承認申請できる
- [ ] 承認申請後、ステータスが「承認待ち」に変わる
- [ ] 承認申請成功時、確認メッセージが表示される

---

### US-JNL-008: 仕訳承認

**として**: 経理責任者
**したい**: 承認待ちの仕訳を承認したい
**なぜなら**: 仕訳の正当性を確認し確定に進めるため

**関連**: UC-JNL-008, BUC-001

**受入条件**:

- [ ] 「承認待ち」ステータスの仕訳のみ承認できる
- [ ] 承認後、ステータスが「承認済み」に変わる
- [ ] 承認者と承認日時が記録される
- [ ] 承認成功時、確認メッセージが表示される

---

### US-JNL-009: 仕訳差し戻し

**として**: 経理責任者
**したい**: 承認待ちの仕訳を差し戻したい
**なぜなら**: 修正が必要な仕訳を経理担当者に戻すため

**関連**: UC-JNL-009, BUC-001

**受入条件**:

- [ ] 「承認待ち」ステータスの仕訳のみ差し戻しできる
- [ ] 差し戻し理由を入力できる
- [ ] 差し戻し後、ステータスが「下書き」に戻る
- [ ] 差し戻し成功時、確認メッセージが表示される

---

### US-JNL-010: 仕訳確定

**として**: 経理責任者
**したい**: 承認済みの仕訳を確定したい
**なぜなら**: 仕訳を元帳に反映し、編集不可にするため

**関連**: UC-JNL-010, BUC-001

**受入条件**:

- [ ] 「承認済み」ステータスの仕訳のみ確定できる
- [ ] 確定後、ステータスが「確定」に変わる
- [ ] 確定した仕訳は編集・削除できない
- [ ] 確定時に元帳に転記される
- [ ] 確定成功時、確認メッセージが表示される

---

## 元帳・残高管理

### US-LDG-001: 総勘定元帳照会

**として**: 経理担当者
**したい**: 総勘定元帳を照会したい
**なぜなら**: 勘定科目ごとの取引履歴と残高を確認するため

**関連**: UC-LDG-001, BUC-001

**受入条件**:

- [ ] 勘定科目を選択して元帳を表示できる
- [ ] 日付、仕訳番号、摘要、借方金額、貸方金額、残高が表示される
- [ ] 期間を指定して絞り込みできる
- [ ] 仕訳の詳細画面に遷移できる

---

### US-LDG-002: 補助元帳照会

**として**: 経理担当者
**したい**: 補助元帳を照会したい
**なぜなら**: 取引先別や部門別の明細を確認するため

**関連**: UC-LDG-002, BUC-001

**受入条件**:

- [ ] 勘定科目と補助科目を選択して元帳を表示できる
- [ ] 日付、仕訳番号、摘要、借方金額、貸方金額、残高が表示される
- [ ] 期間を指定して絞り込みできる

---

### US-LDG-003: 日次残高照会

**として**: 経理担当者
**したい**: 日次の残高を照会したい
**なぜなら**: 日々の残高変動を確認するため

**関連**: UC-LDG-003, BUC-001

**受入条件**:

- [ ] 勘定科目を選択して日次残高を表示できる
- [ ] 日付、借方合計、貸方合計、残高が表示される
- [ ] 期間を指定して絞り込みできる
- [ ] 残高の推移をグラフで表示できる

---

### US-LDG-004: 月次残高照会

**として**: 経理責任者
**したい**: 月次の残高を照会したい
**なぜなら**: 月次の財務状況を把握するため

**関連**: UC-LDG-004, BUC-002

**受入条件**:

- [ ] 勘定科目を選択して月次残高を表示できる
- [ ] 月、借方合計、貸方合計、残高が表示される
- [ ] 年度を指定して絞り込みできる
- [ ] 月次推移をグラフで表示できる

---

### US-LDG-005: 残高試算表表示

**として**: 経理責任者
**したい**: 残高試算表を表示したい
**なぜなら**: 全勘定科目の残高と貸借一致を確認するため

**関連**: UC-LDG-005, BUC-002

**受入条件**:

- [ ] 全勘定科目の借方残高、貸方残高が一覧表示される
- [ ] 借方合計と貸方合計が一致していることを確認できる
- [ ] 基準日を指定して残高を計算できる
- [ ] 勘定科目種別ごとの小計が表示される

---

## 財務諸表

### US-FS-001: 貸借対照表表示

**として**: 経理責任者
**したい**: 貸借対照表を表示したい
**なぜなら**: 企業の財務状況を把握するため

**関連**: UC-FS-001, BUC-002, BUC-003

**受入条件**:

- [ ] 資産、負債、純資産の各科目と金額が表示される
- [ ] 資産合計と負債・純資産合計が一致している
- [ ] 基準日を指定して表示できる
- [ ] 前期比較ができる
- [ ] PDF/Excel でダウンロードできる

---

### US-FS-002: 損益計算書表示

**として**: 経理責任者
**したい**: 損益計算書を表示したい
**なぜなら**: 企業の収益性を把握するため

**関連**: UC-FS-002, BUC-002, BUC-003

**受入条件**:

- [ ] 収益、費用の各科目と金額が表示される
- [ ] 売上総利益、営業利益、経常利益、当期純利益が計算される
- [ ] 期間を指定して表示できる
- [ ] 前期比較ができる
- [ ] PDF/Excel でダウンロードできる

---

### US-FS-003: 財務分析表示

**として**: 経営者
**したい**: 財務分析指標を確認したい
**なぜなら**: 経営判断の参考にするため

**関連**: UC-FS-003, BUC-004

**受入条件**:

- [ ] ROE、ROA、流動比率、自己資本比率などの指標が表示される
- [ ] 各指標の算出根拠が確認できる
- [ ] 期間推移をグラフで表示できる
- [ ] 業界平均との比較ができる

---

## システム管理

### US-SYS-001: 監査ログ照会

**として**: システム管理者
**したい**: 監査ログを照会したい
**なぜなら**: システムの利用状況を監査するため

**関連**: UC-SYS-001, BUC-006

**受入条件**:

- [ ] 日時、ユーザーID、操作内容、操作対象が一覧表示される
- [ ] ユーザーID、操作日時、操作種別で検索できる
- [ ] ログイン履歴が確認できる
- [ ] データ変更履歴が確認できる

---

### US-SYS-002: データダウンロード

**として**: 経理担当者
**したい**: 各種データをダウンロードしたい
**なぜなら**: 外部ツールで分析したり、帳票として印刷するため

**関連**: UC-SYS-002, BUC-006

**受入条件**:

- [ ] 仕訳一覧を CSV/Excel でダウンロードできる
- [ ] 元帳を CSV/Excel でダウンロードできる
- [ ] 試算表を CSV/Excel/PDF でダウンロードできる
- [ ] 財務諸表を CSV/Excel/PDF でダウンロードできる
- [ ] ダウンロード時に期間や条件を指定できる

---

## 優先度の定義

| 優先度 | 説明 |
|--------|------|
| 必須 | システムの基本機能として必ず実装する |
| 重要 | 業務効率向上のために実装を推奨する |
| 任意 | あれば便利だが、後回しにしても問題ない |

---

## 見積もり基準

ストーリーポイントの見積もり基準は以下のとおりです。

| ポイント | 複雑度 | 目安 |
|----------|--------|------|
| 1 | 非常に簡単 | 数時間で完了 |
| 2 | 簡単 | 1日以内で完了 |
| 3 | 標準 | 2-3日で完了 |
| 5 | やや複雑 | 3-5日で完了 |
| 8 | 複雑 | 1週間程度 |
| 13 | 非常に複雑 | 分割を検討 |
