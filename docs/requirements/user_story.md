# ユーザーストーリー - 財務会計システム

## 概要

本ドキュメントは、財務会計システムのユーザーストーリーを定義します。
各ストーリーはシステムユースケースとトレーサビリティを維持しています。

---

## 認証・ユーザー管理

### US001: ログイン

**ストーリー**:
> ユーザーとして、ユーザー名とパスワードでログインしたい。なぜなら、システムの機能を利用するためである。

**受け入れ基準**:
- [ ] ユーザー名とパスワードを入力できる
- [ ] 認証に成功するとダッシュボードが表示される
- [ ] 認証に失敗するとエラーメッセージが表示される
- [ ] 5回連続失敗でアカウントがロックされる
- [ ] JWT トークンが発行される

**関連**: UC001

---

### US002: ログアウト

**ストーリー**:
> ユーザーとして、ログアウトしたい。なぜなら、セキュリティを確保するためである。

**受け入れ基準**:
- [ ] ログアウトボタンをクリックするとログイン画面に戻る
- [ ] セッションが無効化される

**関連**: UC001

---

### US003: ユーザー登録

**ストーリー**:
> 管理者として、新しいユーザーを登録したい。なぜなら、スタッフにシステムアクセス権限を付与するためである。

**受け入れ基準**:
- [ ] ユーザー名、メールアドレス、ロールを入力できる
- [ ] 登録後、ユーザー一覧に追加される
- [ ] 重複するメールアドレスは登録できない
- [ ] 登録操作が監査ログに記録される

**関連**: UC018

---

### US004: ユーザー編集

**ストーリー**:
> 管理者として、ユーザー情報を編集したい。なぜなら、権限やロールを変更するためである。

**受け入れ基準**:
- [ ] 既存ユーザーを選択して編集画面を表示できる
- [ ] ユーザー情報を更新できる
- [ ] 更新操作が監査ログに記録される

**関連**: UC018

---

### US005: ユーザー削除

**ストーリー**:
> 管理者として、ユーザーを削除したい。なぜなら、退職者のアカウントを無効化するためである。

**受け入れ基準**:
- [ ] 確認ダイアログが表示される
- [ ] 削除後、ユーザー一覧から除外される
- [ ] 削除操作が監査ログに記録される

**関連**: UC018

---

## マスタ管理

### US006: 勘定科目一覧表示

**ストーリー**:
> 経理担当者として、勘定科目の一覧を確認したい。なぜなら、使用可能な科目を把握するためである。

**受け入れ基準**:
- [ ] 勘定科目が一覧表示される
- [ ] 科目コード、科目名、科目種別が表示される
- [ ] 階層構造が視覚的に表示される

**関連**: UC002

---

### US007: 勘定科目登録

**ストーリー**:
> 経理担当者として、新しい勘定科目を登録したい。なぜなら、新たな取引に対応するためである。

**受け入れ基準**:
- [ ] 科目コード、科目名、科目種別、親科目を入力できる
- [ ] 重複する科目コードは登録できない
- [ ] 登録後、一覧に追加される
- [ ] 登録操作が監査ログに記録される

**関連**: UC002

---

### US008: 勘定科目編集

**ストーリー**:
> 経理担当者として、勘定科目を編集したい。なぜなら、科目名や構成を修正するためである。

**受け入れ基準**:
- [ ] 既存科目を選択して編集できる
- [ ] 更新後、一覧に反映される
- [ ] 更新操作が監査ログに記録される

**関連**: UC002

---

### US009: 会計期間登録

**ストーリー**:
> 管理者として、会計期間を登録したい。なぜなら、期間別の会計管理を行うためである。

**受け入れ基準**:
- [ ] 期間名、開始日、終了日を入力できる
- [ ] 期間が重複する場合はエラーになる
- [ ] 登録後、一覧に追加される

**関連**: UC003

---

### US010: 課税マスタ登録

**ストーリー**:
> 管理者として、課税区分と税率を登録したい。なぜなら、消費税を正確に計算するためである。

**受け入れ基準**:
- [ ] 課税区分、税率、適用開始日を入力できる
- [ ] 適用期間が重複する場合はエラーになる
- [ ] 登録後、一覧に追加される

**関連**: UC004

---

## 仕訳管理

### US011: 仕訳入力

**ストーリー**:
> 経理担当者として、取引を仕訳として入力したい。なぜなら、日々の取引を記録するためである。

**受け入れ基準**:
- [ ] 仕訳日付を入力できる
- [ ] 借方科目と借方金額を入力できる
- [ ] 貸方科目と貸方金額を入力できる
- [ ] 消費税が自動計算される
- [ ] 貸借バランスがチェックされる
- [ ] 摘要を入力できる
- [ ] 下書きとして保存できる

**関連**: UC005

---

### US012: 複合仕訳入力

**ストーリー**:
> 経理担当者として、複数の借方・貸方を持つ複合仕訳を入力したい。なぜなら、複雑な取引を1つの仕訳で記録するためである。

**受け入れ基準**:
- [ ] 複数の借方明細を追加できる
- [ ] 複数の貸方明細を追加できる
- [ ] 合計の貸借バランスがチェックされる

**関連**: UC005

---

### US013: 仕訳承認申請

**ストーリー**:
> 経理担当者として、仕訳の承認を申請したい。なぜなら、上長の確認を得るためである。

**受け入れ基準**:
- [ ] 下書き状態の仕訳に対して承認申請できる
- [ ] 申請後、仕訳が承認待ち状態になる
- [ ] 承認者に通知される

**関連**: UC005

---

### US014: 仕訳検索

**ストーリー**:
> 経理担当者として、過去の仕訳を検索したい。なぜなら、取引内容を確認するためである。

**受け入れ基準**:
- [ ] 期間で検索できる
- [ ] 勘定科目で検索できる
- [ ] 金額範囲で検索できる
- [ ] 摘要のキーワードで検索できる
- [ ] 検索結果が一覧表示される

**関連**: UC006

---

### US015: 仕訳承認

**ストーリー**:
> 経理マネージャーとして、仕訳を承認したい。なぜなら、仕訳の正確性を確認して確定するためである。

**受け入れ基準**:
- [ ] 承認待ち仕訳の一覧が表示される
- [ ] 仕訳の内容を確認できる
- [ ] 承認ボタンで承認できる
- [ ] 承認後、仕訳が承認済み状態になる
- [ ] 承認後、元帳に転記される
- [ ] 承認操作が監査ログに記録される

**関連**: UC007

---

### US016: 仕訳差戻し

**ストーリー**:
> 経理マネージャーとして、仕訳を差し戻したい。なぜなら、修正が必要な仕訳を担当者に戻すためである。

**受け入れ基準**:
- [ ] 差戻しボタンで差し戻しできる
- [ ] 差戻しコメントを入力できる
- [ ] 差戻し後、仕訳が差戻し状態になる
- [ ] 担当者に通知される

**関連**: UC007

---

### US017: 仕訳一括承認

**ストーリー**:
> 経理マネージャーとして、複数の仕訳を一括承認したい。なぜなら、承認作業を効率化するためである。

**受け入れ基準**:
- [ ] 複数の仕訳をチェックボックスで選択できる
- [ ] 一括承認ボタンで選択した仕訳を一括承認できる
- [ ] 各仕訳の承認が監査ログに記録される

**関連**: UC007

---

### US018: CSV仕訳インポート

**ストーリー**:
> 経理担当者として、CSVファイルから仕訳を一括取り込みたい。なぜなら、大量の仕訳を効率的に登録するためである。

**受け入れ基準**:
- [ ] CSVファイルを選択できる
- [ ] プレビューで取り込み内容を確認できる
- [ ] エラー行がハイライト表示される
- [ ] インポート実行で仕訳が一括登録される
- [ ] インポート結果が表示される

**関連**: UC008

---

## 残高管理

### US019: 日次残高照会

**ストーリー**:
> 経理担当者として、特定日の残高を確認したい。なぜなら、残高の正確性を検証するためである。

**受け入れ基準**:
- [ ] 基準日を選択できる
- [ ] 勘定科目別の残高が一覧表示される
- [ ] 科目を選択して明細を確認できる

**関連**: UC009

---

### US020: 残高推移グラフ表示

**ストーリー**:
> 経理担当者として、残高の推移をグラフで確認したい。なぜなら、傾向を視覚的に把握するためである。

**受け入れ基準**:
- [ ] 期間を指定できる
- [ ] 勘定科目を選択できる
- [ ] 折れ線グラフで推移が表示される

**関連**: UC009

---

### US021: 月次残高照会

**ストーリー**:
> 経理担当者として、月次の残高を確認したい。なぜなら、月次決算の準備を行うためである。

**受け入れ基準**:
- [ ] 対象年月を選択できる
- [ ] 勘定科目別の月次残高が一覧表示される
- [ ] 月次推移表を表示できる

**関連**: UC010

---

### US022: 試算表表示

**ストーリー**:
> 経理担当者として、試算表を確認したい。なぜなら、残高の整合性を検証するためである。

**受け入れ基準**:
- [ ] 対象期間を選択できる
- [ ] 合計残高試算表が表示される
- [ ] 借方合計と貸方合計が一致していることを確認できる

**関連**: UC011

---

## 財務諸表

### US023: 貸借対照表表示

**ストーリー**:
> 経営者として、貸借対照表を確認したい。なぜなら、会社の財務状況を把握するためである。

**受け入れ基準**:
- [ ] 基準日を選択できる
- [ ] 資産、負債、純資産が適切に分類表示される
- [ ] 勘定式と報告式を切り替えられる
- [ ] 期間比較表示ができる

**関連**: UC012

---

### US024: 損益計算書表示

**ストーリー**:
> 経営者として、損益計算書を確認したい。なぜなら、会社の収益性を把握するためである。

**受け入れ基準**:
- [ ] 対象期間を選択できる
- [ ] 収益と費用が適切に分類表示される
- [ ] 段階利益（売上総利益、営業利益、経常利益、当期純利益）が表示される
- [ ] 売上比率分析ができる

**関連**: UC013

---

### US025: キャッシュフロー計算書表示

**ストーリー**:
> 経営者として、キャッシュフロー計算書を確認したい。なぜなら、資金繰りを把握するためである。

**受け入れ基準**:
- [ ] 対象期間を選択できる
- [ ] 営業活動、投資活動、財務活動のキャッシュフローが表示される
- [ ] 間接法で表示される

**関連**: UC014

---

## 決算処理

### US026: 月次締め実行

**ストーリー**:
> 経理マネージャーとして、月次締めを実行したい。なぜなら、月次決算を確定するためである。

**受け入れ基準**:
- [ ] 対象年月を選択できる
- [ ] 未承認仕訳がある場合はエラーになる
- [ ] 確認ダイアログが表示される
- [ ] 実行後、対象月が締め済み状態になる
- [ ] 締め操作が監査ログに記録される

**関連**: UC015

---

### US027: 月次締め解除

**ストーリー**:
> 経理マネージャーとして、月次締めを解除したい。なぜなら、修正が必要な場合に対応するためである。

**受け入れ基準**:
- [ ] 特別権限が必要
- [ ] 確認ダイアログが表示される
- [ ] 実行後、対象月がオープン状態になる
- [ ] 解除操作が監査ログに記録される

**関連**: UC015

---

### US028: 決算整理仕訳入力

**ストーリー**:
> 経理マネージャーとして、決算整理仕訳を入力したい。なぜなら、年次決算のための調整を行うためである。

**受け入れ基準**:
- [ ] 決算整理仕訳として入力できる
- [ ] 通常仕訳と区別して管理される

**関連**: UC016

---

### US029: 年次決算実行

**ストーリー**:
> 経理マネージャーとして、年次決算を実行したい。なぜなら、会計年度を締めるためである。

**受け入れ基準**:
- [ ] 全月が締め済みであることが確認される
- [ ] 確認ダイアログが表示される
- [ ] 実行後、年次決算が完了する
- [ ] 繰越処理が実行される
- [ ] 決算操作が監査ログに記録される

**関連**: UC016

---

## 帳票出力

### US030: CSV出力

**ストーリー**:
> 経理マネージャーとして、データをCSV形式で出力したい。なぜなら、他システムでデータを利用するためである。

**受け入れ基準**:
- [ ] 出力対象を選択できる
- [ ] CSVファイルがダウンロードされる

**関連**: UC017

---

### US031: Excel出力

**ストーリー**:
> 経理マネージャーとして、データをExcel形式で出力したい。なぜなら、加工や分析を行うためである。

**受け入れ基準**:
- [ ] 出力対象を選択できる
- [ ] Excelファイルがダウンロードされる

**関連**: UC017

---

### US032: PDF出力

**ストーリー**:
> 経理マネージャーとして、帳票をPDF形式で出力したい。なぜなら、印刷や保管のためである。

**受け入れ基準**:
- [ ] 出力対象を選択できる
- [ ] PDFファイルがダウンロードされる
- [ ] 印刷用にフォーマットされている

**関連**: UC017

---

## 監査

### US033: 操作履歴照会

**ストーリー**:
> 管理者として、操作履歴を確認したい。なぜなら、セキュリティ監査を行うためである。

**受け入れ基準**:
- [ ] 期間で検索できる
- [ ] ユーザーで検索できる
- [ ] 操作種別で検索できる
- [ ] 操作日時、ユーザー、操作内容が一覧表示される

**関連**: UC019

---

### US034: 仕訳変更履歴照会

**ストーリー**:
> 管理者として、仕訳の変更履歴を確認したい。なぜなら、仕訳の変更を追跡するためである。

**受け入れ基準**:
- [ ] 仕訳番号で検索できる
- [ ] 期間で検索できる
- [ ] 変更前後の内容が表示される
- [ ] 変更日時と変更者が表示される

**関連**: UC019

---

### US035: ログイン履歴照会

**ストーリー**:
> 管理者として、ログイン履歴を確認したい。なぜなら、不正アクセスを検知するためである。

**受け入れ基準**:
- [ ] 期間で検索できる
- [ ] ユーザーで検索できる
- [ ] ログイン日時、ユーザー、IPアドレス、結果が一覧表示される
- [ ] 失敗したログイン試行が識別できる

**関連**: UC019

---

## ユーザーストーリー一覧

| US ID | 名称 | アクター | 関連UC |
|-------|------|---------|--------|
| US001 | ログイン | ユーザー | UC001 |
| US002 | ログアウト | ユーザー | UC001 |
| US003 | ユーザー登録 | 管理者 | UC018 |
| US004 | ユーザー編集 | 管理者 | UC018 |
| US005 | ユーザー削除 | 管理者 | UC018 |
| US006 | 勘定科目一覧表示 | 経理担当者 | UC002 |
| US007 | 勘定科目登録 | 経理担当者 | UC002 |
| US008 | 勘定科目編集 | 経理担当者 | UC002 |
| US009 | 会計期間登録 | 管理者 | UC003 |
| US010 | 課税マスタ登録 | 管理者 | UC004 |
| US011 | 仕訳入力 | 経理担当者 | UC005 |
| US012 | 複合仕訳入力 | 経理担当者 | UC005 |
| US013 | 仕訳承認申請 | 経理担当者 | UC005 |
| US014 | 仕訳検索 | 経理担当者 | UC006 |
| US015 | 仕訳承認 | 経理マネージャー | UC007 |
| US016 | 仕訳差戻し | 経理マネージャー | UC007 |
| US017 | 仕訳一括承認 | 経理マネージャー | UC007 |
| US018 | CSV仕訳インポート | 経理担当者 | UC008 |
| US019 | 日次残高照会 | 経理担当者 | UC009 |
| US020 | 残高推移グラフ表示 | 経理担当者 | UC009 |
| US021 | 月次残高照会 | 経理担当者 | UC010 |
| US022 | 試算表表示 | 経理担当者 | UC011 |
| US023 | 貸借対照表表示 | 経営者 | UC012 |
| US024 | 損益計算書表示 | 経営者 | UC013 |
| US025 | キャッシュフロー計算書表示 | 経営者 | UC014 |
| US026 | 月次締め実行 | 経理マネージャー | UC015 |
| US027 | 月次締め解除 | 経理マネージャー | UC015 |
| US028 | 決算整理仕訳入力 | 経理マネージャー | UC016 |
| US029 | 年次決算実行 | 経理マネージャー | UC016 |
| US030 | CSV出力 | 経理マネージャー | UC017 |
| US031 | Excel出力 | 経理マネージャー | UC017 |
| US032 | PDF出力 | 経理マネージャー | UC017 |
| US033 | 操作履歴照会 | 管理者 | UC019 |
| US034 | 仕訳変更履歴照会 | 管理者 | UC019 |
| US035 | ログイン履歴照会 | 管理者 | UC019 |

---

## トレーサビリティマトリクス（UC → US）

| UC | ユーザーストーリー |
|----|--------------------|
| UC001 | US001, US002 |
| UC002 | US006, US007, US008 |
| UC003 | US009 |
| UC004 | US010 |
| UC005 | US011, US012, US013 |
| UC006 | US014 |
| UC007 | US015, US016, US017 |
| UC008 | US018 |
| UC009 | US019, US020 |
| UC010 | US021 |
| UC011 | US022 |
| UC012 | US023 |
| UC013 | US024 |
| UC014 | US025 |
| UC015 | US026, US027 |
| UC016 | US028, US029 |
| UC017 | US030, US031, US032 |
| UC018 | US003, US004, US005 |
| UC019 | US033, US034, US035 |
